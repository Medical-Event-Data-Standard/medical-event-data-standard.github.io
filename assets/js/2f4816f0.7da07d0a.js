"use strict";(self.webpackChunktemp=self.webpackChunktemp||[]).push([[616],{88630:(e,l,o)=>{o.r(l),o.d(l,{assets:()=>s,contentTitle:()=>r,default:()=>w,frontMatter:()=>u,metadata:()=>n,toc:()=>m});const n=JSON.parse('{"id":"tutorials/kdd2025/build_a_model_NN","title":"Build a (Neural Network) Model over MEDS data","description":"In this tutorial, we\'ll use the dataset we extracted previously and build a neural network model to predict","source":"@site/docs/tutorials/kdd2025/build_a_model_NN.mdx","sourceDirName":"tutorials/kdd2025","slug":"/tutorials/kdd2025/build_a_model_NN","permalink":"/docs/tutorials/kdd2025/build_a_model_NN","draft":false,"unlisted":false,"editUrl":"https://github.com/Medical-Event-Data-Standard/medical-event-data-standard.github.io/tree/main/docs/docs/tutorials/kdd2025/build_a_model_NN.mdx","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"mainSidebar","previous":{"title":"Build a (Tabular Baseline) Model over MEDS data","permalink":"/docs/tutorials/kdd2025/build_a_model_tabular"},"next":{"title":"MEDS Ecosystem","permalink":"/docs/intro_pages/ecosystem"}}');var t=o(74848),d=o(28453),_=o(32971),i=o.n(_);const a=JSON.parse('{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"collapsed_sections":["BqGKFAVzTEvP","oDqeVwjZS2Mi","nBcgMwO9S3sU","C99aOVYjS59Z"]},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"fee5e837fc0f4c169ef0b375a16aa779":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_c44b0bb9ff2c4a4b83fc615e1be08c75","IPY_MODEL_3f36e82b131049a68ab556238e644856","IPY_MODEL_dab0c7c48c834a7fb32c6d1931a62789"],"layout":"IPY_MODEL_42b9a7130d6a482c916b810298d330a0"}},"c44b0bb9ff2c4a4b83fc615e1be08c75":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c444e43f425b44f4881b4a094558909b","placeholder":"\u200b","style":"IPY_MODEL_4163e8458bb44ee1a3995b2e46708368","value":"Sanity\u2007Checking\u2007DataLoader\u20070:\u2007100%"}},"3f36e82b131049a68ab556238e644856":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_7da4282dd844462b948850a95e56f783","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_81d6e33cb75240909a8b8f89a61156c2","value":1}},"dab0c7c48c834a7fb32c6d1931a62789":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c44b4f351164455285db59ef282f98bc","placeholder":"\u200b","style":"IPY_MODEL_5edc063d44b64f099ff249846223f827","value":"\u20071/1\u2007[00:00&lt;00:00,\u200726.39it/s]"}},"42b9a7130d6a482c916b810298d330a0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":"100%"}},"c444e43f425b44f4881b4a094558909b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4163e8458bb44ee1a3995b2e46708368":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7da4282dd844462b948850a95e56f783":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"81d6e33cb75240909a8b8f89a61156c2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"c44b4f351164455285db59ef282f98bc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5edc063d44b64f099ff249846223f827":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1bba7f1a94b24ca79d29e23d63761d0c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ba501d4e1e7b43fdb61ed46a76479c19","IPY_MODEL_c72eb37420ed4696836fc22326352001","IPY_MODEL_45fed74c168d4495814e7e2a3fa14aa5"],"layout":"IPY_MODEL_ea15d977ec994a67ba3b65fcdb0c50f4"}},"ba501d4e1e7b43fdb61ed46a76479c19":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6990f9d636c64a4da3cf96b7770a0403","placeholder":"\u200b","style":"IPY_MODEL_1f2c68d20c5b48fb9e0791fc448e1f48","value":"Epoch\u20079:\u2007100%"}},"c72eb37420ed4696836fc22326352001":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_200ccea1b1e24409b28b6aa9e4620321","max":3,"min":0,"orientation":"horizontal","style":"IPY_MODEL_1e9c21d8d34242469cfa0bb3606f9504","value":3}},"45fed74c168d4495814e7e2a3fa14aa5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e2153426ccb5413ca9ec19e45d0ac300","placeholder":"\u200b","style":"IPY_MODEL_9255d245a8c74122968c4110fe0a25ea","value":"\u20073/3\u2007[00:01&lt;00:00,\u2007\u20072.77it/s,\u2007v_num=6,\u2007val_acc=0.700,\u2007train_acc=0.973]"}},"ea15d977ec994a67ba3b65fcdb0c50f4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"100%"}},"6990f9d636c64a4da3cf96b7770a0403":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1f2c68d20c5b48fb9e0791fc448e1f48":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"200ccea1b1e24409b28b6aa9e4620321":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1e9c21d8d34242469cfa0bb3606f9504":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"e2153426ccb5413ca9ec19e45d0ac300":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9255d245a8c74122968c4110fe0a25ea":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2e2f66703207491da8621bda458dde54":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_57fd55a7863348bf9efa1e36bac67b72","IPY_MODEL_c9e304f2a2a94dffadce60346e8934e4","IPY_MODEL_cf3afaab618a4bf6badcb60761dab2ed"],"layout":"IPY_MODEL_58a30f18fb38482fa88dae510f7b84f0"}},"57fd55a7863348bf9efa1e36bac67b72":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5893cde0c9cc4017b13d2cd17d0bf5c8","placeholder":"\u200b","style":"IPY_MODEL_8a03d7c697694e31ab6a86f8bfca1975","value":"Validation\u2007DataLoader\u20070:\u2007100%"}},"c9e304f2a2a94dffadce60346e8934e4":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_fa047aa5a6e04f9c8af6629b951ece1d","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_d860500f38324880a6bd83824567a657","value":1}},"cf3afaab618a4bf6badcb60761dab2ed":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_07fe724d42a94193bbb26542f20c6f5d","placeholder":"\u200b","style":"IPY_MODEL_19deb398af26459f85c5a72c4a548f12","value":"\u20071/1\u2007[00:00&lt;00:00,\u200728.65it/s]"}},"58a30f18fb38482fa88dae510f7b84f0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":"100%"}},"5893cde0c9cc4017b13d2cd17d0bf5c8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8a03d7c697694e31ab6a86f8bfca1975":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"fa047aa5a6e04f9c8af6629b951ece1d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d860500f38324880a6bd83824567a657":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"07fe724d42a94193bbb26542f20c6f5d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"19deb398af26459f85c5a72c4a548f12":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a96401218abb4318a0891b31d6295125":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_06048cb54c294d7784186d7504645db5","IPY_MODEL_d87fd536565c4d52b5c34c06a4b3bdf3","IPY_MODEL_e493156f833a476cb8cbebf73b315f76"],"layout":"IPY_MODEL_e89a8905ea9c4178886fbe6fa319e65d"}},"06048cb54c294d7784186d7504645db5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_917c3e04af604d7f9065ffcc1456e562","placeholder":"\u200b","style":"IPY_MODEL_6de59751885c420e8e444c611996a3e6","value":"Validation\u2007DataLoader\u20070:\u2007100%"}},"d87fd536565c4d52b5c34c06a4b3bdf3":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_a2af25f5c0b74ce98d8a97ef7eb0971b","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_356355a057f6436cb89f33c7dff02b34","value":1}},"e493156f833a476cb8cbebf73b315f76":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_88582d98233a49d9ab497095e8ec6623","placeholder":"\u200b","style":"IPY_MODEL_1edabb5c310f4bfba96d8088435c9a53","value":"\u20071/1\u2007[00:00&lt;00:00,\u200729.13it/s]"}},"e89a8905ea9c4178886fbe6fa319e65d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":"100%"}},"917c3e04af604d7f9065ffcc1456e562":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6de59751885c420e8e444c611996a3e6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a2af25f5c0b74ce98d8a97ef7eb0971b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"356355a057f6436cb89f33c7dff02b34":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"88582d98233a49d9ab497095e8ec6623":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1edabb5c310f4bfba96d8088435c9a53":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c99dcc68f73f4428984a5eea38e2cc02":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_835af8fa7c704a0e95b9b815dfe5f88b","IPY_MODEL_1fbfd1280776438598927c75d86f8f00","IPY_MODEL_62b2b33dc1ee404395d5421f14ecc8a5"],"layout":"IPY_MODEL_bc4b2eb0156c4ad4b1206604e6cfa487"}},"835af8fa7c704a0e95b9b815dfe5f88b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8cbb465061294724b910089f21d76ba4","placeholder":"\u200b","style":"IPY_MODEL_0408710cb23143df906b327afd9bff96","value":"Validation\u2007DataLoader\u20070:\u2007100%"}},"1fbfd1280776438598927c75d86f8f00":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_f150d179f0b544ef8524dcc848250c8c","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_60e0cbd0c10042fe93cf1661d53d772e","value":1}},"62b2b33dc1ee404395d5421f14ecc8a5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2f07311445194a91a84b19e8cd8ccb0c","placeholder":"\u200b","style":"IPY_MODEL_a798905e415c43ccb7c09ee03380c6fd","value":"\u20071/1\u2007[00:00&lt;00:00,\u200724.03it/s]"}},"bc4b2eb0156c4ad4b1206604e6cfa487":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":"100%"}},"8cbb465061294724b910089f21d76ba4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0408710cb23143df906b327afd9bff96":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f150d179f0b544ef8524dcc848250c8c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"60e0cbd0c10042fe93cf1661d53d772e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"2f07311445194a91a84b19e8cd8ccb0c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a798905e415c43ccb7c09ee03380c6fd":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"23e4473f5d7c4c87a377f2a526f6dee2":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_0dc84bff36b1405fb4804e91a1b26431","IPY_MODEL_4cfbb8202801447e9c47c78d7c2e80d8","IPY_MODEL_2742c6185f354177b1fab709340796f0"],"layout":"IPY_MODEL_7d724a83a46744e5af3bfcc3e6f2b643"}},"0dc84bff36b1405fb4804e91a1b26431":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b92a91b903684090b264ec03ff151b33","placeholder":"\u200b","style":"IPY_MODEL_512e4b48e60741eab63b6a43b065b95e","value":"Validation\u2007DataLoader\u20070:\u2007100%"}},"4cfbb8202801447e9c47c78d7c2e80d8":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_d48ccbe02d90406aac82078ab58d57ed","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_05e88d673adc4247bf5f3e588c301241","value":1}},"2742c6185f354177b1fab709340796f0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7acd4d8f91d941cfb5c3610bc2dfe74a","placeholder":"\u200b","style":"IPY_MODEL_ba764e4edda440deacbd1db292302aa3","value":"\u20071/1\u2007[00:00&lt;00:00,\u200725.69it/s]"}},"7d724a83a46744e5af3bfcc3e6f2b643":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":"100%"}},"b92a91b903684090b264ec03ff151b33":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"512e4b48e60741eab63b6a43b065b95e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d48ccbe02d90406aac82078ab58d57ed":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"05e88d673adc4247bf5f3e588c301241":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"7acd4d8f91d941cfb5c3610bc2dfe74a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ba764e4edda440deacbd1db292302aa3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"202785b99ad34e16a00431342f079c66":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_425d2d23496048468bba5170768290f8","IPY_MODEL_0245a866cfad418f9e899e71eda95a3a","IPY_MODEL_67e1de4cfc1e4ef2a76a43e7a60f3c29"],"layout":"IPY_MODEL_795beef4e1144a14820150d40c81420e"}},"425d2d23496048468bba5170768290f8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d029f1b2f5b74528b25fec85a1ba04fa","placeholder":"\u200b","style":"IPY_MODEL_96800ab24acd4873a3c053fd421f5bf2","value":"Validation\u2007DataLoader\u20070:\u2007100%"}},"0245a866cfad418f9e899e71eda95a3a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_a45a131c0fe14ca2ba8ad3924a78ec22","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_0a7d0c7f24484378b9950a4c0461fdfe","value":1}},"67e1de4cfc1e4ef2a76a43e7a60f3c29":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c5fc8ae5a8804bec83d526c52f8c72ce","placeholder":"\u200b","style":"IPY_MODEL_1a6a2d11c6bc466e8522acf80f038a34","value":"\u20071/1\u2007[00:00&lt;00:00,\u200718.84it/s]"}},"795beef4e1144a14820150d40c81420e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":"100%"}},"d029f1b2f5b74528b25fec85a1ba04fa":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"96800ab24acd4873a3c053fd421f5bf2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a45a131c0fe14ca2ba8ad3924a78ec22":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0a7d0c7f24484378b9950a4c0461fdfe":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"c5fc8ae5a8804bec83d526c52f8c72ce":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1a6a2d11c6bc466e8522acf80f038a34":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3c73668b8cef448f9b7fb1b781181d8d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_cc6cf49d3523488a8e5024223c242e90","IPY_MODEL_0b342dd589714dccad996470850f393c","IPY_MODEL_9da9100cccae430db2de357b241b1be3"],"layout":"IPY_MODEL_643af7e9bff64824ad973e9b9c297dbe"}},"cc6cf49d3523488a8e5024223c242e90":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6ce9c6ec11174093b6e91e10dfa64aa9","placeholder":"\u200b","style":"IPY_MODEL_37906ba6d829417891ec045ae0e9c7e0","value":"Validation\u2007DataLoader\u20070:\u2007100%"}},"0b342dd589714dccad996470850f393c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_f851e1ea99b74974814deb941003de9b","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ff6ed69e80734ffd9cfa444343ea048a","value":1}},"9da9100cccae430db2de357b241b1be3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_97cc207e293041b5a36fce558f0700d1","placeholder":"\u200b","style":"IPY_MODEL_45ab504601b340debdcaade8583661e3","value":"\u20071/1\u2007[00:00&lt;00:00,\u200727.37it/s]"}},"643af7e9bff64824ad973e9b9c297dbe":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":"100%"}},"6ce9c6ec11174093b6e91e10dfa64aa9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"37906ba6d829417891ec045ae0e9c7e0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f851e1ea99b74974814deb941003de9b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ff6ed69e80734ffd9cfa444343ea048a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"97cc207e293041b5a36fce558f0700d1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"45ab504601b340debdcaade8583661e3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"67a7af0e5afd4d228868f6ad67261959":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f1a9a1a1de2448edb2f36305c0744304","IPY_MODEL_239aa52f28d54c2ca205e049e3092d37","IPY_MODEL_6c3943e327a1473cabdaf38164945f76"],"layout":"IPY_MODEL_78137263219c4b948b1ae688824b88b1"}},"f1a9a1a1de2448edb2f36305c0744304":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_aefa2113fdad4f3e8131a6189dbc0e68","placeholder":"\u200b","style":"IPY_MODEL_576399e3f76641cabceb5302a4a999d4","value":"Validation\u2007DataLoader\u20070:\u2007100%"}},"239aa52f28d54c2ca205e049e3092d37":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_c25f4496891e406d82e094764b24206d","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_4877f2addd5940cca726ebef1b2cbe25","value":1}},"6c3943e327a1473cabdaf38164945f76":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ec51d8c5c69648769fc6415203d8ed59","placeholder":"\u200b","style":"IPY_MODEL_bc5169294d894de0b4e7be256876e64d","value":"\u20071/1\u2007[00:00&lt;00:00,\u200726.54it/s]"}},"78137263219c4b948b1ae688824b88b1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":"100%"}},"aefa2113fdad4f3e8131a6189dbc0e68":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"576399e3f76641cabceb5302a4a999d4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c25f4496891e406d82e094764b24206d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4877f2addd5940cca726ebef1b2cbe25":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ec51d8c5c69648769fc6415203d8ed59":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bc5169294d894de0b4e7be256876e64d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"cdda6c47a6b94a85ba9bf5226d8c599e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_5823e675f5374a89807beb9e8c7f963c","IPY_MODEL_93053ca85edd4cdbb774cac1fa56df8f","IPY_MODEL_3a65c4e73b4146458ba3c3b0a95add45"],"layout":"IPY_MODEL_3fc883765da14a50975879c4a3182873"}},"5823e675f5374a89807beb9e8c7f963c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_43c48720e7914113b49061ecf19b25ff","placeholder":"\u200b","style":"IPY_MODEL_1a50c2df5844498a9b7836dfad7c4359","value":"Validation\u2007DataLoader\u20070:\u2007100%"}},"93053ca85edd4cdbb774cac1fa56df8f":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_7624f323661b4f8ca9a8a6620421baa0","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ddfb6014e7cd4a4291d05c374ac483d6","value":1}},"3a65c4e73b4146458ba3c3b0a95add45":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b93d8f7f7b2a40b690516a312980f9d5","placeholder":"\u200b","style":"IPY_MODEL_5af721c06872447bb4e91c918825bc06","value":"\u20071/1\u2007[00:00&lt;00:00,\u200732.79it/s]"}},"3fc883765da14a50975879c4a3182873":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":"100%"}},"43c48720e7914113b49061ecf19b25ff":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1a50c2df5844498a9b7836dfad7c4359":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7624f323661b4f8ca9a8a6620421baa0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ddfb6014e7cd4a4291d05c374ac483d6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b93d8f7f7b2a40b690516a312980f9d5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5af721c06872447bb4e91c918825bc06":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"748ed09914654f60893d2701fe7d8af5":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_473de7c2e34e4ab5924857cc23fb6ffe","IPY_MODEL_e4b39b374219420a855acc753afaf1a9","IPY_MODEL_7ceadd6cd9ba4364a5b82607e1c7f117"],"layout":"IPY_MODEL_cbd30eb7c8e14c7a9c2f36ead3d2ee53"}},"473de7c2e34e4ab5924857cc23fb6ffe":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_615ca67f59fa44098c8f6219df50495f","placeholder":"\u200b","style":"IPY_MODEL_c756e0f6f4fb46979ab254bf3fe38d92","value":"Validation\u2007DataLoader\u20070:\u2007100%"}},"e4b39b374219420a855acc753afaf1a9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_a68ee1c7df0e4e668d2c4c6075420e76","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ed8e026c618e4bfa9ee13d3b8720256f","value":1}},"7ceadd6cd9ba4364a5b82607e1c7f117":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4cfd051ff6544a268b85ed102a056dbe","placeholder":"\u200b","style":"IPY_MODEL_c69a2d1b94224816bec302054d98d2ca","value":"\u20071/1\u2007[00:00&lt;00:00,\u200730.04it/s]"}},"cbd30eb7c8e14c7a9c2f36ead3d2ee53":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":"100%"}},"615ca67f59fa44098c8f6219df50495f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c756e0f6f4fb46979ab254bf3fe38d92":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a68ee1c7df0e4e668d2c4c6075420e76":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ed8e026c618e4bfa9ee13d3b8720256f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"4cfd051ff6544a268b85ed102a056dbe":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c69a2d1b94224816bec302054d98d2ca":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f3afe2c2efb54ef39df4b718d084623e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_afcb7a155a1a4e6abba673a9afca9846","IPY_MODEL_4cf0314b0cb24fd89391fa08ed207f97","IPY_MODEL_80be9982b8d84a4286cab7c7b7ea6860"],"layout":"IPY_MODEL_68d174ad4e334513a65aa8570a907dfa"}},"afcb7a155a1a4e6abba673a9afca9846":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0e736c2a95b84ae394452f1ba424adfa","placeholder":"\u200b","style":"IPY_MODEL_ecb60f5ed0c74c02bad4a9f0a6ab7323","value":"Validation\u2007DataLoader\u20070:\u2007100%"}},"4cf0314b0cb24fd89391fa08ed207f97":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_f5abf0c87e58468fa38307e574d70e83","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_672fc6cb41c84c6e8984d7163f79ef51","value":1}},"80be9982b8d84a4286cab7c7b7ea6860":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b54abfa25dea4d558195f81f48019c35","placeholder":"\u200b","style":"IPY_MODEL_088696b42c684c348d01568e6f02c981","value":"\u20071/1\u2007[00:00&lt;00:00,\u200729.66it/s]"}},"68d174ad4e334513a65aa8570a907dfa":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":"100%"}},"0e736c2a95b84ae394452f1ba424adfa":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ecb60f5ed0c74c02bad4a9f0a6ab7323":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f5abf0c87e58468fa38307e574d70e83":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"672fc6cb41c84c6e8984d7163f79ef51":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b54abfa25dea4d558195f81f48019c35":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"088696b42c684c348d01568e6f02c981":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"69add712c3374cb191caa20926b343e3":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f14631f9d2154cf4b8ab8546916f9241","IPY_MODEL_ef1202853920404f8f0a79e2439a2dd5","IPY_MODEL_4a8289d9840b40ad80ed58d7166b067d"],"layout":"IPY_MODEL_8b8b6f1da5c84d7da974833c12e37c1f"}},"f14631f9d2154cf4b8ab8546916f9241":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_12c2c567add04c978ea18d0f5e6a1b2a","placeholder":"\u200b","style":"IPY_MODEL_946db01903724afe8d0da75e740aec73","value":"Testing\u2007DataLoader\u20070:\u2007100%"}},"ef1202853920404f8f0a79e2439a2dd5":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_b9b03fcc481d4616925d78e87c627dae","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_8823519ae4a5481bb82cfed5d1b748d6","value":1}},"4a8289d9840b40ad80ed58d7166b067d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_923fbf11cf124323ae2ea521d931c49e","placeholder":"\u200b","style":"IPY_MODEL_1595ef13cd99402d86c48d6262f83133","value":"\u20071/1\u2007[00:00&lt;00:00,\u200732.51it/s]"}},"8b8b6f1da5c84d7da974833c12e37c1f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"100%"}},"12c2c567add04c978ea18d0f5e6a1b2a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"946db01903724afe8d0da75e740aec73":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b9b03fcc481d4616925d78e87c627dae":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8823519ae4a5481bb82cfed5d1b748d6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"923fbf11cf124323ae2ea521d931c49e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1595ef13cd99402d86c48d6262f83133":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"markdown","source":["# Building a Model\\n","\\n","In this part of the tutorial, we\'ll walk through the task of building a (neural network) model with MEDS\\n","\\n","We will continue exactly where we\'ve left off in the previous part of the tutorial. Our task is to predict *a short ICU stay* (of < 3 days) given the patient\'s input data. We have already transformed the dataset into the MEDS format and extracted a set of label files for the dataset, and built a baseline model -- now, let\'s go a bit further!\\n","\\n","Let\'s download the files we produced in the prior sections from the tutorial resources:"],"metadata":{"id":"iZtRYC4ZO5v_"}},{"cell_type":"code","source":["%%bash\\n","wget -q -c https://github.com/Medical-Event-Data-Standard/MEDS_KDD_2025_Tutorial/raw/refs/heads/main/MEDS_data.zip\\n","\\n","unzip -q -o MEDS_data.zip\\n","\\n","apt-get -qq install tree\\n","tree MEDS_data"],"metadata":{"id":"AT-jrgCYsNud","colab":{"base_uri":"https://localhost:8080/"},"outputId":"72e0c334-ef02-4682-d746-175e560bd23c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Selecting previously unselected package tree.\\r\\n","(Reading database ... \\r(Reading database ... 5%\\r(Reading database ... 10%\\r(Reading database ... 15%\\r(Reading database ... 20%\\r(Reading database ... 25%\\r(Reading database ... 30%\\r(Reading database ... 35%\\r(Reading database ... 40%\\r(Reading database ... 45%\\r(Reading database ... 50%\\r(Reading database ... 55%\\r(Reading database ... 60%\\r(Reading database ... 65%\\r(Reading database ... 70%\\r(Reading database ... 75%\\r(Reading database ... 80%\\r(Reading database ... 85%\\r(Reading database ... 90%\\r(Reading database ... 95%\\r(Reading database ... 100%\\r(Reading database ... 126284 files and directories currently installed.)\\r\\n","Preparing to unpack .../tree_2.0.2-1_amd64.deb ...\\r\\n","Unpacking tree (2.0.2-1) ...\\r\\n","Setting up tree (2.0.2-1) ...\\r\\n","Processing triggers for man-db (2.10.2-1) ...\\r\\n","MEDS_data\\n","\u251c\u2500\u2500 data\\n","\u2502\xa0\xa0 \u251c\u2500\u2500 held_out\\n","\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 0.parquet\\n","\u2502\xa0\xa0 \u251c\u2500\u2500 train\\n","\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 0.parquet\\n","\u2502\xa0\xa0 \u2514\u2500\u2500 tuning\\n","\u2502\xa0\xa0     \u2514\u2500\u2500 0.parquet\\n","\u251c\u2500\u2500 labels\\n","\u2502\xa0\xa0 \u2514\u2500\u2500 short_LOS\\n","\u2502\xa0\xa0     \u251c\u2500\u2500 held_out\\n","\u2502\xa0\xa0     \u2502\xa0\xa0 \u2514\u2500\u2500 0.parquet\\n","\u2502\xa0\xa0     \u251c\u2500\u2500 train\\n","\u2502\xa0\xa0     \u2502\xa0\xa0 \u2514\u2500\u2500 0.parquet\\n","\u2502\xa0\xa0     \u2514\u2500\u2500 tuning\\n","\u2502\xa0\xa0         \u2514\u2500\u2500 0.parquet\\n","\u2514\u2500\u2500 metadata\\n","    \u251c\u2500\u2500 codes.parquet\\n","    \u251c\u2500\u2500 dataset.json\\n","    \u2514\u2500\u2500 subject_splits.parquet\\n","\\n","10 directories, 9 files\\n"]}]},{"cell_type":"code","source":["from pathlib import Path\\n","import pandas as pd\\n","\\n","data_root = Path(\\"MEDS_data/data\\")\\n","labels_root = Path(\\"MEDS_data/labels/short_LOS\\")\\n","metadata_root = Path(\\"MEDS_data/metadata\\")\\n","\\n","train_data = pd.read_parquet(data_root / \\"train\\")[[\\"subject_id\\", \\"time\\", \\"code\\", \\"numeric_value\\", \\"text_value\\"]]\\n","train_labels = pd.read_parquet(labels_root / \\"train\\")[[\\"subject_id\\", \\"prediction_time\\", \\"boolean_value\\"]]"],"metadata":{"id":"PTjYFaGhHLhG"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## A Neural Network Model\\n","\\n","Building a neural network model is inherently very different than building a tabular baseline. There are lots of questions we\'ll need to answer to do this effectively; questions like:\\n","  1. What kind of neural network do we want to build?\\n","  2. How will it need its data pre-processed?\\n","  3. How will we train this neural network?\\n","\\n","All of these will dictate what we need to do with our data to build the right kind of model."],"metadata":{"id":"Ev6yzOFFSxqo"}},{"cell_type":"markdown","source":["For this tutorial, we\'ll build a pretty simple model. We\'ll take the patient\'s sequence of measurements, ordered by time (_note this is a bit ambiguous -- many measurements happen at the same time point_), and apply a simple, 1D convolution over those measurements, embedded via a simple strategy using an embedding of the code and the numeric value, if present. We\'ll bubble this convolution up to a single output, and use that to make our prediction.\\n","\\n","This modeling strategy is reasonable, but definitely also has some issues -- it doesn\'t take into account time (or the fact that many measurements happen at the same time), we aren\'t using static data, and we don\'t know if convolution is the right way to model patient data here. But for this tutorial, its sufficient."],"metadata":{"id":"3Wiee6GpR4ZU"}},{"cell_type":"markdown","source":["## How is (this kind) of a NN different than our tabularized baseline?"],"metadata":{"id":"24MQufVbw1tD"}},{"cell_type":"markdown","source":["In our tabular baseline, our primary challenge was identifying how to take a dataset and extract a fixed size set of tabular features that explicitly summarized the longitudinal MEDS data. This approach was necessary because tabular baselines can only take in fixed size data -- not sequential data.\\n","\\n","But, neural networks (or at least the kind we\'re building here, as well as many other architectures) _can_ work with sequential data directly. This means that here, our challenge is not one of manual featurization, but instead is one of transforming our raw data into a format suitable for ingestion by this kind of neural network.\\n","\\n","To do so, we have to meet a few constraints:\\n","  1. Neural networks can\'t take in text features directly. Instead, for our codes (as well as for the `text_value` column, if we wanted to use that), we need to put them in a form suitable for embedding.\\n","  2. Neural networks can take in variable length sequences but still have a limit. This means that we need a vehicle to both encode too-short sequences (e.g., a patient who has less data in total than the maximum size sequence our model can process) and too-long sequences (a sequence of patient data longer than this maximum limit). We also need to make sure that when we try to predict a label for a task sample with a given prediction time, we don\'t use data from beyond that time.\\n","  3. We need to make sure we can easily and efficiently load data in our model, without wasting valuable compute resources on repeated, non-modeling work."],"metadata":{"id":"UmtClgEyw8eX"}},{"cell_type":"markdown","source":["Here\'s how we\'ll solve these challenges:\\n","\\n","1. **Embedding**: We\'ll do this in the normal way--by assigning an integer index for each unique code, then passing those indices into the model to be parsed with an embedding matrix.\\n","2. **Sequence Lengths**: We\'ll use a _padding index_ to represent sequence elements (i.e., codes) that are not actually present (e.g., if a patient\'s data is too short), and we\'ll truncate sequences that are too long. There are many ways we could truncate sequences -- in this case, as we\'re trying to make a prediction as of a specific time, we\'ll use the longest contiguous sequence allowed that ends on or before the specified prediction time.\\n","3. **Efficient Processing**: We\'ll follow best practices and perform as many calculations as we can in advance of modeling time, and store just the data we need (in a format suitable for efficient subsequence slicing) on disk before we start modeling. Then, each batch of modeling, we\'ll just need to load the data we need and we\'ll be good to go! For this, we\'ll use existing external packages, and most of the details will be outside the scope of this tutorial."],"metadata":{"id":"Bt0UrioQx5AD"}},{"cell_type":"markdown","source":["## MEDS TorchData"],"metadata":{"id":"YzdoAYcrw9xh"}},{"cell_type":"markdown","source":["To help us out, we\'ll use a tool from the MEDS ecosystem that makes it easier to get the data in the right format. This tool is [MEDS TorchData](https://meds-torch-data.readthedocs.io/en/latest/) -- we won\'t go through all the details of how it works, but suffice it to say it has a couple of capabilities we can use:\\n","  1. It comes with a script that will pre-process our dataset, ensuring that: (a) every code is assigned to a integer index suitable for an embedding matrix, (b) numeric values are centered and scaled to have zero mean and unit variance, and (c) data are written to disk in a manner that permits easy loading in a PyTorch dataset.\\n","  2. It comes with a [PyTorch dataset](https://docs.pytorch.org/tutorials/beginner/basics/data_tutorial.html) class we can inherit and instantiate that will let us work with the data in a straightforward manner.\\n","  3. It lets us integrate natively with [Lightning](https://lightning.ai/docs/pytorch/stable/) if we want to use that to help streamline training (which we will here).\\n","\\n","Let\'s install it and see it in action!\\n","\\n","_Note: Installation may take some time. Additionally, if you see any pip dependency errors about polars versions, this is not something to worry about._"],"metadata":{"id":"Y6b_FW64R5zP"}},{"cell_type":"code","source":["%%bash\\n","pip install --quiet meds-torch-data[lightning]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"mrRedE6cS8DA","outputId":"ccaa56e3-e0b5-4631-af45-cea35cb5434a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["     \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 57.2/57.2 kB 2.6 MB/s eta 0:00:00\\n","   \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 821.1/821.1 kB 22.2 MB/s eta 0:00:00\\n","   \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 200.6/200.6 kB 13.6 MB/s eta 0:00:00\\n","   \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 36.3/36.3 MB 39.1 MB/s eta 0:00:00\\n","   \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 363.4/363.4 MB 5.3 MB/s eta 0:00:00\\n","   \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 13.8/13.8 MB 103.7 MB/s eta 0:00:00\\n","   \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 24.6/24.6 MB 83.3 MB/s eta 0:00:00\\n","   \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 883.7/883.7 kB 43.2 MB/s eta 0:00:00\\n","   \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 664.8/664.8 MB 1.2 MB/s eta 0:00:00\\n","   \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 211.5/211.5 MB 5.8 MB/s eta 0:00:00\\n","   \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 56.3/56.3 MB 12.9 MB/s eta 0:00:00\\n","   \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 127.9/127.9 MB 8.0 MB/s eta 0:00:00\\n","   \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 207.5/207.5 MB 7.3 MB/s eta 0:00:00\\n","   \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 21.1/21.1 MB 55.0 MB/s eta 0:00:00\\n","   \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 154.5/154.5 kB 9.8 MB/s eta 0:00:00\\n","   \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 57.1/57.1 kB 4.0 MB/s eta 0:00:00\\n","   \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 981.9/981.9 kB 37.8 MB/s eta 0:00:00\\n","   \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 825.4/825.4 kB 35.6 MB/s eta 0:00:00\\n"]},{"output_type":"stream","name":"stderr","text":["ERROR: pip\'s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\\n","cudf-polars-cu12 25.6.0 requires polars<1.29,>=1.25, but you have polars 1.30.0 which is incompatible.\\n"]}]},{"cell_type":"markdown","source":["### Data Pre-processing\\n","\\n","After installation, the next step is to pre-process our dataset. Following [the documentation](https://meds-torch-data.readthedocs.io/en/latest/#step-2-data-tensorization), all we have to do is run the following command."],"metadata":{"id":"BqGKFAVzTEvP"}},{"cell_type":"code","source":["%%bash\\n","MTD_preprocess MEDS_dataset_dir=\\"MEDS_data\\" output_dir=\\"tensorized_MEDS_data\\""],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"g7vsg_TrTUPo","outputId":"7b49b792-0ca4-4dba-a49a-7dccbf164a33"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[2025-07-31 18:13:40,721][meds_torchdata.preprocessing.__main__][INFO] - Running in serial mode as N_WORKERS is not set.\\n","[2025-07-31 18:13:40,722][meds_torchdata.preprocessing.__main__][INFO] - Running command: INPUT_DIR=/content/MEDS_data OUTPUT_DIR=/content/tensorized_MEDS_data MEDS_transform-pipeline --config-path=/usr/local/lib/python3.11/dist-packages/meds_torchdata/preprocessing/configs --config-name=runner pipeline_config_fp=/usr/local/lib/python3.11/dist-packages/meds_torchdata/preprocessing/configs/_MTD_preprocess.yaml ~parallelize ++do_overwrite=False\\n"]}]},{"cell_type":"markdown","source":["Let\'s see what that command produced!"],"metadata":{"id":"6ZY8KFifTot4"}},{"cell_type":"code","source":["%%bash\\n","tree tensorized_MEDS_data"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"sEBIfJqcTqpZ","outputId":"d0b555d7-1843-4445-b9aa-5ae6b18796a7"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["tensorized_MEDS_data\\n","\u251c\u2500\u2500 data\\n","\u2502\xa0\xa0 \u251c\u2500\u2500 held_out\\n","\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 0.nrt\\n","\u2502\xa0\xa0 \u251c\u2500\u2500 train\\n","\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 0.nrt\\n","\u2502\xa0\xa0 \u2514\u2500\u2500 tuning\\n","\u2502\xa0\xa0     \u2514\u2500\u2500 0.nrt\\n","\u251c\u2500\u2500 fit_normalization\\n","\u2502\xa0\xa0 \u251c\u2500\u2500 codes.parquet\\n","\u2502\xa0\xa0 \u2514\u2500\u2500 train\\n","\u2502\xa0\xa0     \u2514\u2500\u2500 0.parquet\\n","\u251c\u2500\u2500 fit_vocabulary_indices\\n","\u251c\u2500\u2500 metadata\\n","\u2502\xa0\xa0 \u2514\u2500\u2500 codes.parquet\\n","\u251c\u2500\u2500 normalization\\n","\u2502\xa0\xa0 \u251c\u2500\u2500 held_out\\n","\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 0.parquet\\n","\u2502\xa0\xa0 \u251c\u2500\u2500 train\\n","\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 0.parquet\\n","\u2502\xa0\xa0 \u2514\u2500\u2500 tuning\\n","\u2502\xa0\xa0     \u2514\u2500\u2500 0.parquet\\n","\u2514\u2500\u2500 tokenization\\n","    \u251c\u2500\u2500 event_seqs\\n","    \u2502\xa0\xa0 \u251c\u2500\u2500 held_out\\n","    \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 0.parquet\\n","    \u2502\xa0\xa0 \u251c\u2500\u2500 train\\n","    \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 0.parquet\\n","    \u2502\xa0\xa0 \u2514\u2500\u2500 tuning\\n","    \u2502\xa0\xa0     \u2514\u2500\u2500 0.parquet\\n","    \u2514\u2500\u2500 schemas\\n","        \u251c\u2500\u2500 held_out\\n","        \u2502\xa0\xa0 \u2514\u2500\u2500 0.parquet\\n","        \u251c\u2500\u2500 train\\n","        \u2502\xa0\xa0 \u2514\u2500\u2500 0.parquet\\n","        \u2514\u2500\u2500 tuning\\n","            \u2514\u2500\u2500 0.parquet\\n","\\n","21 directories, 15 files\\n"]}]},{"cell_type":"markdown","source":["There are a number of files that are in this folder. Luckily, we don\'t need to understand them all to use them -- we can let MEDS TorchData handle that for us if we set up our dataset properly. Let\'s check it out!\\n","\\n","_Note: If you\'re interested, check out [this part of the documentation](https://meds-torch-data.readthedocs.io/en/latest/#data-tensorization-and-pre-processing-details) and the documentation for the [nested-ragged-tensors](https://nested-ragged-tensors.readthedocs.io/en/latest/) package for more information!_"],"metadata":{"id":"XWLFbfs3TweM"}},{"cell_type":"markdown","source":["### A PyTorch Dataset\\n","To build a pytorch dataset, we first consturct a configuration object that defines the parameters of the dataset we want to create. There are a number of options supported by MEDS TorchData. Options about ways to work with static data, how you want your data represented, etc. For now, we\'ll use the following configuration file to kick off our modeling exploration. To explore different options, check out [the documentation](https://meds-torch-data.readthedocs.io/en/latest/#medstorchdataconfig-configuration-object)."],"metadata":{"id":"oDqeVwjZS2Mi"}},{"cell_type":"code","source":["from meds_torchdata import MEDSTorchDataConfig\\n","\\n","tensorized_cohort_dir = Path(\\"tensorized_MEDS_data\\")\\n","\\n","config = MEDSTorchDataConfig(\\n","    tensorized_cohort_dir,            # Our tensorized data directory\\n","    max_seq_len=256,                  # How many measurements we want\\n","    seq_sampling_strategy=\\"to_end\\",   # What part of the patient\'s data to grab\\n","    static_inclusion_mode=\\"omit\\",     # What to do with static data\\n","    task_labels_dir=labels_root,      # Our labels\\n",")"],"metadata":{"id":"DTM52io7Un_o"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["Now, with our config defined, let\'s build a dataset and see some data!"],"metadata":{"id":"Zl5t6ksJVnPE"}},{"cell_type":"code","source":["from meds_torchdata import MEDSPytorchDataset\\n","\\n","pyd = MEDSPytorchDataset(config, split=\\"train\\")\\n","print(f\\"Dataset constructed with {len(pyd)} samples!\\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"e4IT2B4DVqCk","outputId":"9c58a99d-c496-4a6f-b892-d4af53de941f"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Dataset constructed with 74 samples!\\n"]}]},{"cell_type":"markdown","source":["Inspecting data in a pytorch dataset can be a bit hard. We can simplify this by looking at full batches which have a special print function. We can use the built in dataloader function to help with this:"],"metadata":{"id":"tkT_AdU6WEpY"}},{"cell_type":"code","source":["dataloader = pyd.get_dataloader(batch_size=16)\\n","batch = next(iter(dataloader))\\n","print(batch)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3qSsxQkiWO41","outputId":"278affd9-95ff-44a0-bb4d-807283f644de"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["MEDSTorchBatch:\\n","\u2502 Mode: Subject-Measurement (SM)\\n","\u2502 Static data? \u2717\\n","\u2502 Labels? \u2713\\n","\u2502\\n","\u2502 Shape:\\n","\u2502 \u2502 Batch size: 16\\n","\u2502 \u2502 Sequence length: 256\\n","\u2502 \u2502\\n","\u2502 \u2502 All dynamic data: (16, 256)\\n","\u2502 \u2502 Labels: torch.Size([16])\\n","\u2502\\n","\u2502 Data:\\n","\u2502 \u2502 Dynamic:\\n","\u2502 \u2502 \u2502 time_delta_days (torch.float32):\\n","\u2502 \u2502 \u2502 \u2502 [[0.00, 0.00,  ..., 0.00, 0.00],\\n","\u2502 \u2502 \u2502 \u2502  [0.00, 0.00,  ..., 0.00, 0.00],\\n","\u2502 \u2502 \u2502 \u2502  ...,\\n","\u2502 \u2502 \u2502 \u2502  [0.00, 0.00,  ..., 0.00, 0.00],\\n","\u2502 \u2502 \u2502 \u2502  [0.00, 0.00,  ..., 0.00, 0.01]]\\n","\u2502 \u2502 \u2502 code (torch.int64):\\n","\u2502 \u2502 \u2502 \u2502 [[1980, 2150,  ..., 2692, 6529],\\n","\u2502 \u2502 \u2502 \u2502  [1985, 2007,  ..., 2009, 6529],\\n","\u2502 \u2502 \u2502 \u2502  ...,\\n","\u2502 \u2502 \u2502 \u2502  [1983, 1995,  ..., 2162, 2134],\\n","\u2502 \u2502 \u2502 \u2502  [2770, 1982,  ..., 1997, 1704]]\\n","\u2502 \u2502 \u2502 numeric_value (torch.float32):\\n","\u2502 \u2502 \u2502 \u2502 [[-0.49,  0.00,  ..., -0.10, -0.80],\\n","\u2502 \u2502 \u2502 \u2502  [-0.71,  1.12,  ...,  0.34, -0.46],\\n","\u2502 \u2502 \u2502 \u2502  ...,\\n","\u2502 \u2502 \u2502 \u2502  [ 0.33, -0.19,  ...,  0.00,  0.00],\\n","\u2502 \u2502 \u2502 \u2502  [-1.01,  0.00,  ...,  0.50, -0.31]]\\n","\u2502 \u2502 \u2502 numeric_value_mask (torch.bool):\\n","\u2502 \u2502 \u2502 \u2502 [[ True, False,  ...,  True,  True],\\n","\u2502 \u2502 \u2502 \u2502  [ True,  True,  ...,  True,  True],\\n","\u2502 \u2502 \u2502 \u2502  ...,\\n","\u2502 \u2502 \u2502 \u2502  [ True,  True,  ..., False, False],\\n","\u2502 \u2502 \u2502 \u2502  [ True, False,  ...,  True,  True]]\\n","\u2502 \u2502\\n","\u2502 \u2502 Labels:\\n","\u2502 \u2502 \u2502 boolean_value (torch.bool):\\n","\u2502 \u2502 \u2502 \u2502 [False, False,  ...,  True, False]\\n"]}]},{"cell_type":"markdown","source":["This will be the structure we can work with in our model -- we\'ll have access to 2D tensors of time deltas, codes, and numeric values (with a mask indicating when numeric values were present).\\n","\\n","_**Note:** The time-deltas here are not normalized, and are often zero, as many measurements occur at the same point in time. This is normal, but may or may not be desired for your particular model application._"],"metadata":{"id":"-FDz6HvyWiCP"}},{"cell_type":"code","source":["print(batch.PAD_INDEX)\\n","print(batch.code)\\n","print(batch.numeric_value)\\n","print(batch.numeric_value_mask)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"PWQ-nQ-KYHlW","outputId":"47e285e2-043d-49c1-a28b-104912b40810"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["0\\n","tensor([[1980, 2150, 2708,  ..., 1982, 2692, 6529],\\n","        [1985, 2007, 2000,  ..., 2878, 2009, 6529],\\n","        [2885, 2407, 2203,  ..., 2216, 2206, 2207],\\n","        ...,\\n","        [2692, 2235, 2198,  ..., 3042, 3031, 3023],\\n","        [1983, 1995, 1979,  ..., 2157, 2162, 2134],\\n","        [2770, 1982, 2003,  ..., 1998, 1997, 1704]])\\n","tensor([[-0.4875,  0.0000,  0.0000,  ...,  0.0000, -0.1005, -0.8004],\\n","        [-0.7122,  1.1156,  0.7586,  ...,  0.0000,  0.3388, -0.4600],\\n","        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],\\n","        ...,\\n","        [ 0.0227, -0.0556, -0.3237,  ...,  0.0000,  0.0000,  0.0000],\\n","        [ 0.3286, -0.1904, -0.5563,  ...,  0.0000,  0.0000,  0.0000],\\n","        [-1.0095,  0.0000,  0.5741,  ..., -0.6803,  0.4985, -0.3070]])\\n","tensor([[ True, False, False,  ..., False,  True,  True],\\n","        [ True,  True,  True,  ..., False,  True,  True],\\n","        [False, False, False,  ..., False, False, False],\\n","        ...,\\n","        [ True,  True,  True,  ..., False, False, False],\\n","        [ True,  True,  True,  ..., False, False, False],\\n","        [ True, False,  True,  ...,  True,  True,  True]])\\n"]}]},{"cell_type":"markdown","source":["### Building the model\\n","\\n","Using this, let\'s go ahead and build our model! Given we know what the batch will contain, all that\'s left is to put together our model\'s structure."],"metadata":{"id":"nBcgMwO9S3sU"}},{"cell_type":"code","source":["import torch.nn as nn\\n","import torch\\n","from meds_torchdata import MEDSTorchBatch\\n","\\n","class SimpleConv(nn.Module):\\n","    \\"\\"\\"\\n","    1D-convolutional model for sequence + static inputs.\\n","\\n","    Pipeline\\n","    --------\\n","    1) Embed code indices (with padding_idx).\\n","    2) Concatenate [code_embedding, numeric_value_mask, numeric_value] per timestep.\\n","    3) Pass through a Conv1d stack over time -> global pooling -> fixed-size sequence embedding.\\n","    4) Embed static features (linear MLP projection).\\n","    5) Concatenate [sequence_embedding, static_embedding] -> predict labels.\\n","\\n","    Inputs (forward)\\n","    ----------------\\n","    batch.code: LongTensor of shape (B, T)\\n","        Tokenized code indices, padded with `pad_index`.\\n","    batch.numeric_value: FloatTensor of shape (B, T)\\n","        Numeric values (e.g., lab values) aligned with `code_idx`. Should be pre-normalized.\\n","    batch.numeric_value_mask: Bool/FloatTensor of shape (B, T)\\n","        1 if numeric_value is present/valid for that timestep, else 0.\\n","\\n","    Output\\n","    ------\\n","    logits: FloatTensor of shape (B,)\\n","        Raw (unnormalized) predictions. Apply sigmoid/softmax outside as appropriate.\\n","\\n","    Notes\\n","    -----\\n","    - Padding handling: The embedding uses `padding_idx` so padded positions produce a zero vector.\\n","      With ReLU activations and global max pooling, padded zeros will not dominate non-pad activations.\\n","    \\"\\"\\"\\n","\\n","    def __init__(\\n","        self,\\n","        *,\\n","        code_vocab_size: int,\\n","        pad_index: int = MEDSTorchBatch.PAD_INDEX,\\n","        code_embed_dim: int = 128,\\n","        conv_channels=(128, 128, 128),\\n","        conv_kernel_sizes=(5, 5, 3),\\n","        conv_dropout: float = 0.1,\\n","        head_hidden_dim: int = 128,\\n","        act: nn.Module = nn.ReLU,\\n","    ):\\n","        super().__init__()\\n","        assert len(conv_channels) == len(conv_kernel_sizes), \\"conv_channels and conv_kernel_sizes must be same length\\"\\n","        self.pad_index = pad_index\\n","\\n","        # 1) Code embedding\\n","        self.code_emb = nn.Embedding(\\n","            num_embeddings=code_vocab_size,\\n","            embedding_dim=code_embed_dim,\\n","            padding_idx=pad_index,\\n","        )\\n","\\n","        # 2\u20133) Conv stack over time\\n","        in_ch = code_embed_dim + 2  # [code_emb || numeric_value_mask || numeric_value]\\n","        conv_blocks = []\\n","        for out_ch, k in zip(conv_channels, conv_kernel_sizes):\\n","            conv_blocks += [\\n","                nn.Conv1d(in_channels=in_ch, out_channels=out_ch, kernel_size=k, padding=k // 2),\\n","                nn.BatchNorm1d(out_ch),\\n","                act(),\\n","                nn.Dropout(conv_dropout),\\n","            ]\\n","            in_ch = out_ch\\n","        self.conv = nn.Sequential(*conv_blocks)\\n","        self.pool = nn.AdaptiveMaxPool1d(1)  # -> (B, C, 1) then squeeze to (B, C)\\n","\\n","        # 5) Head\\n","        head_in = conv_channels[-1]\\n","        self.head = nn.Sequential(\\n","            nn.Linear(head_in, head_hidden_dim),\\n","            act(),\\n","            nn.Dropout(conv_dropout),\\n","            nn.Linear(head_hidden_dim, 1),\\n","        )\\n","\\n","        self._reset_parameters()\\n","\\n","    def _reset_parameters(self):\\n","        # Kaiming init for conv/linear; embeddings default init is fine (padding row already handled)\\n","        for m in self.modules():\\n","            if isinstance(m, nn.Conv1d):\\n","                nn.init.kaiming_normal_(m.weight, nonlinearity=\\"relu\\")\\n","                if m.bias is not None:\\n","                    nn.init.zeros_(m.bias)\\n","            elif isinstance(m, nn.Linear):\\n","                nn.init.kaiming_uniform_(m.weight, nonlinearity=\\"relu\\")\\n","                nn.init.zeros_(m.bias)\\n","\\n","    def forward(\\n","        self,\\n","        batch: MEDSTorchBatch\\n","    ) -> torch.Tensor:\\n","        B, T = batch.code.shape\\n","\\n","        # (B, T, E)\\n","        code_e = self.code_emb(batch.code)\\n","\\n","        # Ensure mask is float\\n","        if batch.numeric_value_mask.dtype != torch.float32:\\n","            batch.numeric_value_mask = batch.numeric_value_mask.float()\\n","\\n","        # (B, T, E+2)\\n","        x = torch.cat(\\n","            [code_e, batch.numeric_value_mask.unsqueeze(-1), batch.numeric_value.unsqueeze(-1)],\\n","            dim=-1,\\n","        )\\n","\\n","        # Conv1d expects (B, C, T)\\n","        x = x.transpose(1, 2)  # -> (B, C=E+2, T)\\n","        x = self.conv(x)       # -> (B, C_out, T)\\n","        x = self.pool(x).squeeze(-1)  # -> (B, C_out)\\n","\\n","        logits = self.head(x).squeeze()  # (B,)\\n","        return logits"],"metadata":{"id":"lwHaaYI8YaL8"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["Let\'s see if it runs!"],"metadata":{"id":"s-JRgxo6rj7G"}},{"cell_type":"code","source":["M = SimpleConv(code_vocab_size=config.vocab_size)\\n","M(batch)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"xJphXm6-rlUQ","outputId":"34c02581-f4f4-4be9-82d7-4e6ab14f12e0"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([ 7.8502, 10.1843,  4.1388,  6.4581,  8.9709, 11.3923,  6.9392,  7.1074,\\n","         7.2635,  9.4971,  8.3914,  7.9199,  4.2960,  7.1975,  8.3680,  8.2609],\\n","       grad_fn=<SqueezeBackward0>)"]},"metadata":{},"execution_count":22}]},{"cell_type":"markdown","source":["### Training\\n","\\n","What about training this model? For our purposes, we\'ll make this step a bit simpler using [Lightning](https://lightning.ai/docs/pytorch/stable/). To use lightning, we\'ll need to do two things:\\n","  1. Convert our PyTorch dataset into a Lightning DataModule (this is handled for us by MEDS TorchData, as we\'ll see in a moment)\\n","  2. Build a Lightning Module for our model.\\n","\\n","For step 1, as indicated, we can use MEDS TorchData for this; let\'s see it in action:"],"metadata":{"id":"C99aOVYjS59Z"}},{"cell_type":"code","source":["from meds_torchdata.extensions.lightning_datamodule import Datamodule\\n","\\n","dm = Datamodule(config, batch_size=32, num_workers=0, pin_memory=False)\\n","\\n","print(next(iter(dm.train_dataloader())))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"j4-gYh6UsLbQ","outputId":"87613daf-557f-4a48-fd38-e6a65c88b58f"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["MEDSTorchBatch:\\n","\u2502 Mode: Subject-Measurement (SM)\\n","\u2502 Static data? \u2717\\n","\u2502 Labels? \u2713\\n","\u2502\\n","\u2502 Shape:\\n","\u2502 \u2502 Batch size: 32\\n","\u2502 \u2502 Sequence length: 256\\n","\u2502 \u2502\\n","\u2502 \u2502 All dynamic data: (32, 256)\\n","\u2502 \u2502 Labels: torch.Size([32])\\n","\u2502\\n","\u2502 Data:\\n","\u2502 \u2502 Dynamic:\\n","\u2502 \u2502 \u2502 time_delta_days (torch.float32):\\n","\u2502 \u2502 \u2502 \u2502 [[0.00, 0.00,  ..., 0.00, 0.00],\\n","\u2502 \u2502 \u2502 \u2502  [0.00, 0.00,  ..., 0.00, 0.00],\\n","\u2502 \u2502 \u2502 \u2502  ...,\\n","\u2502 \u2502 \u2502 \u2502  [0.00, 0.00,  ..., 0.00, 0.00],\\n","\u2502 \u2502 \u2502 \u2502  [0.00, 0.00,  ..., 0.00, 0.00]]\\n","\u2502 \u2502 \u2502 code (torch.int64):\\n","\u2502 \u2502 \u2502 \u2502 [[2885, 2059,  ..., 2083, 2708],\\n","\u2502 \u2502 \u2502 \u2502  [2739, 2666,  ..., 6566, 1795],\\n","\u2502 \u2502 \u2502 \u2502  ...,\\n","\u2502 \u2502 \u2502 \u2502  [2278, 2057,  ..., 2007, 6529],\\n","\u2502 \u2502 \u2502 \u2502  [6529, 2198,  ..., 2249, 2250]]\\n","\u2502 \u2502 \u2502 numeric_value (torch.float32):\\n","\u2502 \u2502 \u2502 \u2502 [[ 0.00,  0.00,  ..., -0.44,  0.00],\\n","\u2502 \u2502 \u2502 \u2502  [ 0.00,  0.00,  ...,  2.24,  0.18],\\n","\u2502 \u2502 \u2502 \u2502  ...,\\n","\u2502 \u2502 \u2502 \u2502  [ 0.60,  0.00,  ...,  0.77, -0.72],\\n","\u2502 \u2502 \u2502 \u2502  [-0.74, -0.32,  ...,  0.00,  0.00]]\\n","\u2502 \u2502 \u2502 numeric_value_mask (torch.bool):\\n","\u2502 \u2502 \u2502 \u2502 [[False, False,  ...,  True, False],\\n","\u2502 \u2502 \u2502 \u2502  [False, False,  ...,  True,  True],\\n","\u2502 \u2502 \u2502 \u2502  ...,\\n","\u2502 \u2502 \u2502 \u2502  [ True, False,  ...,  True,  True],\\n","\u2502 \u2502 \u2502 \u2502  [ True,  True,  ..., False, False]]\\n","\u2502 \u2502\\n","\u2502 \u2502 Labels:\\n","\u2502 \u2502 \u2502 boolean_value (torch.bool):\\n","\u2502 \u2502 \u2502 \u2502 [False, False,  ...,  True,  True]\\n"]}]},{"cell_type":"markdown","source":["To build our lightning module, we just need to add a few methods to our class. To keep things clean, we\'ll have our module take our PyTorch model class as an input."],"metadata":{"id":"owZbnUFnstW9"}},{"cell_type":"code","source":["import lightning as L\\n","from torchmetrics import Accuracy\\n","\\n","class SimpleConvL(L.LightningModule):\\n","    def __init__(self, lr, **kwargs):\\n","        super().__init__()\\n","        self.save_hyperparameters()\\n","        self.lr = lr\\n","        self.model = SimpleConv(**kwargs)\\n","        self.loss = nn.BCEWithLogitsLoss()\\n","        self.accuracy = Accuracy(task=\\"binary\\")\\n","\\n","    def forward(self, batch: MEDSTorchBatch):\\n","        return self.model(batch)\\n","\\n","    def _step(self, batch: MEDSTorchBatch, split: str):\\n","        logits = self(batch)\\n","        labels = batch.boolean_value.float()\\n","\\n","        loss = self.loss(logits, labels)\\n","        self.log(f\\"{split}_loss\\", loss)\\n","\\n","        preds = (logits > 0).float()\\n","        acc = self.accuracy(preds, labels)\\n","        self.log(\\n","            f\\"{split}_acc\\",\\n","            acc,\\n","            on_step=False,\\n","            on_epoch=True,\\n","            prog_bar=True\\n","        )\\n","\\n","        return loss\\n","\\n","    def training_step(self, batch, _):\\n","        return self._step(batch, \\"train\\")\\n","\\n","    def validation_step(self, batch, _):\\n","        return self._step(batch, \\"val\\")\\n","\\n","    def test_step(self, batch, _):\\n","        return self._step(batch, \\"test\\")\\n","\\n","    def configure_optimizers(self):\\n","        return torch.optim.Adam(self.parameters(), lr=self.lr)"],"metadata":{"id":"nfR_Ld5Qs1c9"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["With these defined, let\'s try training our model!"],"metadata":{"id":"Jhm06S4ouC3E"}},{"cell_type":"code","source":["LM = SimpleConvL(lr=1e-3, code_vocab_size=config.vocab_size)\\n","\\n","trainer = L.Trainer(max_epochs=10, check_val_every_n_epoch=1, log_every_n_steps=1)\\n","trainer.fit(model=LM, datamodule=dm)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":607,"referenced_widgets":["fee5e837fc0f4c169ef0b375a16aa779","c44b0bb9ff2c4a4b83fc615e1be08c75","3f36e82b131049a68ab556238e644856","dab0c7c48c834a7fb32c6d1931a62789","42b9a7130d6a482c916b810298d330a0","c444e43f425b44f4881b4a094558909b","4163e8458bb44ee1a3995b2e46708368","7da4282dd844462b948850a95e56f783","81d6e33cb75240909a8b8f89a61156c2","c44b4f351164455285db59ef282f98bc","5edc063d44b64f099ff249846223f827","1bba7f1a94b24ca79d29e23d63761d0c","ba501d4e1e7b43fdb61ed46a76479c19","c72eb37420ed4696836fc22326352001","45fed74c168d4495814e7e2a3fa14aa5","ea15d977ec994a67ba3b65fcdb0c50f4","6990f9d636c64a4da3cf96b7770a0403","1f2c68d20c5b48fb9e0791fc448e1f48","200ccea1b1e24409b28b6aa9e4620321","1e9c21d8d34242469cfa0bb3606f9504","e2153426ccb5413ca9ec19e45d0ac300","9255d245a8c74122968c4110fe0a25ea","2e2f66703207491da8621bda458dde54","57fd55a7863348bf9efa1e36bac67b72","c9e304f2a2a94dffadce60346e8934e4","cf3afaab618a4bf6badcb60761dab2ed","58a30f18fb38482fa88dae510f7b84f0","5893cde0c9cc4017b13d2cd17d0bf5c8","8a03d7c697694e31ab6a86f8bfca1975","fa047aa5a6e04f9c8af6629b951ece1d","d860500f38324880a6bd83824567a657","07fe724d42a94193bbb26542f20c6f5d","19deb398af26459f85c5a72c4a548f12","a96401218abb4318a0891b31d6295125","06048cb54c294d7784186d7504645db5","d87fd536565c4d52b5c34c06a4b3bdf3","e493156f833a476cb8cbebf73b315f76","e89a8905ea9c4178886fbe6fa319e65d","917c3e04af604d7f9065ffcc1456e562","6de59751885c420e8e444c611996a3e6","a2af25f5c0b74ce98d8a97ef7eb0971b","356355a057f6436cb89f33c7dff02b34","88582d98233a49d9ab497095e8ec6623","1edabb5c310f4bfba96d8088435c9a53","c99dcc68f73f4428984a5eea38e2cc02","835af8fa7c704a0e95b9b815dfe5f88b","1fbfd1280776438598927c75d86f8f00","62b2b33dc1ee404395d5421f14ecc8a5","bc4b2eb0156c4ad4b1206604e6cfa487","8cbb465061294724b910089f21d76ba4","0408710cb23143df906b327afd9bff96","f150d179f0b544ef8524dcc848250c8c","60e0cbd0c10042fe93cf1661d53d772e","2f07311445194a91a84b19e8cd8ccb0c","a798905e415c43ccb7c09ee03380c6fd","23e4473f5d7c4c87a377f2a526f6dee2","0dc84bff36b1405fb4804e91a1b26431","4cfbb8202801447e9c47c78d7c2e80d8","2742c6185f354177b1fab709340796f0","7d724a83a46744e5af3bfcc3e6f2b643","b92a91b903684090b264ec03ff151b33","512e4b48e60741eab63b6a43b065b95e","d48ccbe02d90406aac82078ab58d57ed","05e88d673adc4247bf5f3e588c301241","7acd4d8f91d941cfb5c3610bc2dfe74a","ba764e4edda440deacbd1db292302aa3","202785b99ad34e16a00431342f079c66","425d2d23496048468bba5170768290f8","0245a866cfad418f9e899e71eda95a3a","67e1de4cfc1e4ef2a76a43e7a60f3c29","795beef4e1144a14820150d40c81420e","d029f1b2f5b74528b25fec85a1ba04fa","96800ab24acd4873a3c053fd421f5bf2","a45a131c0fe14ca2ba8ad3924a78ec22","0a7d0c7f24484378b9950a4c0461fdfe","c5fc8ae5a8804bec83d526c52f8c72ce","1a6a2d11c6bc466e8522acf80f038a34","3c73668b8cef448f9b7fb1b781181d8d","cc6cf49d3523488a8e5024223c242e90","0b342dd589714dccad996470850f393c","9da9100cccae430db2de357b241b1be3","643af7e9bff64824ad973e9b9c297dbe","6ce9c6ec11174093b6e91e10dfa64aa9","37906ba6d829417891ec045ae0e9c7e0","f851e1ea99b74974814deb941003de9b","ff6ed69e80734ffd9cfa444343ea048a","97cc207e293041b5a36fce558f0700d1","45ab504601b340debdcaade8583661e3","67a7af0e5afd4d228868f6ad67261959","f1a9a1a1de2448edb2f36305c0744304","239aa52f28d54c2ca205e049e3092d37","6c3943e327a1473cabdaf38164945f76","78137263219c4b948b1ae688824b88b1","aefa2113fdad4f3e8131a6189dbc0e68","576399e3f76641cabceb5302a4a999d4","c25f4496891e406d82e094764b24206d","4877f2addd5940cca726ebef1b2cbe25","ec51d8c5c69648769fc6415203d8ed59","bc5169294d894de0b4e7be256876e64d","cdda6c47a6b94a85ba9bf5226d8c599e","5823e675f5374a89807beb9e8c7f963c","93053ca85edd4cdbb774cac1fa56df8f","3a65c4e73b4146458ba3c3b0a95add45","3fc883765da14a50975879c4a3182873","43c48720e7914113b49061ecf19b25ff","1a50c2df5844498a9b7836dfad7c4359","7624f323661b4f8ca9a8a6620421baa0","ddfb6014e7cd4a4291d05c374ac483d6","b93d8f7f7b2a40b690516a312980f9d5","5af721c06872447bb4e91c918825bc06","748ed09914654f60893d2701fe7d8af5","473de7c2e34e4ab5924857cc23fb6ffe","e4b39b374219420a855acc753afaf1a9","7ceadd6cd9ba4364a5b82607e1c7f117","cbd30eb7c8e14c7a9c2f36ead3d2ee53","615ca67f59fa44098c8f6219df50495f","c756e0f6f4fb46979ab254bf3fe38d92","a68ee1c7df0e4e668d2c4c6075420e76","ed8e026c618e4bfa9ee13d3b8720256f","4cfd051ff6544a268b85ed102a056dbe","c69a2d1b94224816bec302054d98d2ca","f3afe2c2efb54ef39df4b718d084623e","afcb7a155a1a4e6abba673a9afca9846","4cf0314b0cb24fd89391fa08ed207f97","80be9982b8d84a4286cab7c7b7ea6860","68d174ad4e334513a65aa8570a907dfa","0e736c2a95b84ae394452f1ba424adfa","ecb60f5ed0c74c02bad4a9f0a6ab7323","f5abf0c87e58468fa38307e574d70e83","672fc6cb41c84c6e8984d7163f79ef51","b54abfa25dea4d558195f81f48019c35","088696b42c684c348d01568e6f02c981"]},"id":"_Vin_0m_uEMB","outputId":"180977bb-5772-4d1b-d4bc-535de6fc2f17"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["INFO:pytorch_lightning.utilities.rank_zero:\ud83d\udca1 Tip: For seamless cloud uploads and versioning, try installing [litmodels](https://pypi.org/project/litmodels/) to enable LitModelCheckpoint, which syncs automatically with the Lightning model registry.\\n","INFO:pytorch_lightning.utilities.rank_zero:GPU available: False, used: False\\n","INFO:pytorch_lightning.utilities.rank_zero:TPU available: False, using: 0 TPU cores\\n","INFO:pytorch_lightning.utilities.rank_zero:HPU available: False, using: 0 HPUs\\n","INFO: \\n","  | Name     | Type              | Params | Mode \\n","-------------------------------------------------------\\n","0 | model    | SimpleConv        | 1.1 M  | train\\n","1 | loss     | BCEWithLogitsLoss | 0      | train\\n","2 | accuracy | BinaryAccuracy    | 0      | train\\n","-------------------------------------------------------\\n","1.1 M     Trainable params\\n","0         Non-trainable params\\n","1.1 M     Total params\\n","4.318     Total estimated model params size (MB)\\n","23        Modules in train mode\\n","0         Modules in eval mode\\n","INFO:lightning.pytorch.callbacks.model_summary:\\n","  | Name     | Type              | Params | Mode \\n","-------------------------------------------------------\\n","0 | model    | SimpleConv        | 1.1 M  | train\\n","1 | loss     | BCEWithLogitsLoss | 0      | train\\n","2 | accuracy | BinaryAccuracy    | 0      | train\\n","-------------------------------------------------------\\n","1.1 M     Trainable params\\n","0         Non-trainable params\\n","1.1 M     Total params\\n","4.318     Total estimated model params size (MB)\\n","23        Modules in train mode\\n","0         Modules in eval mode\\n"]},{"output_type":"display_data","data":{"text/plain":["Sanity Checking: |          | 0/? [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"fee5e837fc0f4c169ef0b375a16aa779"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Training: |          | 0/? [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"1bba7f1a94b24ca79d29e23d63761d0c"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Validation: |          | 0/? [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"2e2f66703207491da8621bda458dde54"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Validation: |          | 0/? [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"a96401218abb4318a0891b31d6295125"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Validation: |          | 0/? [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"c99dcc68f73f4428984a5eea38e2cc02"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Validation: |          | 0/? [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"23e4473f5d7c4c87a377f2a526f6dee2"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Validation: |          | 0/? [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"202785b99ad34e16a00431342f079c66"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Validation: |          | 0/? [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3c73668b8cef448f9b7fb1b781181d8d"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Validation: |          | 0/? [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"67a7af0e5afd4d228868f6ad67261959"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Validation: |          | 0/? [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"cdda6c47a6b94a85ba9bf5226d8c599e"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Validation: |          | 0/? [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"748ed09914654f60893d2701fe7d8af5"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Validation: |          | 0/? [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"f3afe2c2efb54ef39df4b718d084623e"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["INFO:pytorch_lightning.utilities.rank_zero:`Trainer.fit` stopped: `max_epochs=10` reached.\\n"]}]},{"cell_type":"markdown","source":["With lightning, we can easily test our model too:"],"metadata":{"id":"eJKFZyUpuw-e"}},{"cell_type":"code","source":["trainer.test(model=LM, datamodule=dm)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":162,"referenced_widgets":["69add712c3374cb191caa20926b343e3","f14631f9d2154cf4b8ab8546916f9241","ef1202853920404f8f0a79e2439a2dd5","4a8289d9840b40ad80ed58d7166b067d","8b8b6f1da5c84d7da974833c12e37c1f","12c2c567add04c978ea18d0f5e6a1b2a","946db01903724afe8d0da75e740aec73","b9b03fcc481d4616925d78e87c627dae","8823519ae4a5481bb82cfed5d1b748d6","923fbf11cf124323ae2ea521d931c49e","1595ef13cd99402d86c48d6262f83133"]},"id":"ZwdKefJUuMmK","outputId":"71e4db3f-bdae-4c72-a240-6f1e600ff5f9"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Testing: |          | 0/? [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"69add712c3374cb191caa20926b343e3"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\\n","\u2503\\u001b[1m \\u001b[0m\\u001b[1m       Test metric       \\u001b[0m\\u001b[1m \\u001b[0m\u2503\\u001b[1m \\u001b[0m\\u001b[1m      DataLoader 0       \\u001b[0m\\u001b[1m \\u001b[0m\u2503\\n","\u2521\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2547\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2529\\n","\u2502\\u001b[36m \\u001b[0m\\u001b[36m        test_acc         \\u001b[0m\\u001b[36m \\u001b[0m\u2502\\u001b[35m \\u001b[0m\\u001b[35m          0.375          \\u001b[0m\\u001b[35m \\u001b[0m\u2502\\n","\u2502\\u001b[36m \\u001b[0m\\u001b[36m        test_loss        \\u001b[0m\\u001b[36m \\u001b[0m\u2502\\u001b[35m \\u001b[0m\\u001b[35m   1.6943222284317017    \\u001b[0m\\u001b[35m \\u001b[0m\u2502\\n","\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\\n"],"text/html":["<pre style=\\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,\'DejaVu Sans Mono\',consolas,\'Courier New\',monospace\\">\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\\n","\u2503<span style=\\"font-weight: bold\\">        Test metric        </span>\u2503<span style=\\"font-weight: bold\\">       DataLoader 0        </span>\u2503\\n","\u2521\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2547\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2529\\n","\u2502<span style=\\"color: #008080; text-decoration-color: #008080\\">         test_acc          </span>\u2502<span style=\\"color: #800080; text-decoration-color: #800080\\">           0.375           </span>\u2502\\n","\u2502<span style=\\"color: #008080; text-decoration-color: #008080\\">         test_loss         </span>\u2502<span style=\\"color: #800080; text-decoration-color: #800080\\">    1.6943222284317017     </span>\u2502\\n","\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\\n","</pre>\\n"]},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["[{\'test_loss\': 1.6943222284317017, \'test_acc\': 0.375}]"]},"metadata":{},"execution_count":39}]},{"cell_type":"markdown","source":["Unsurprisingly, for our very small dataset of only ~70 samples, this model has grossly overfit. You should see (from the lightning progress bar description) that the train accuracy has gotten very high, but the test accuracy is still quite poor. But, were you to use this model on the real data--who knows!"],"metadata":{"id":"347ynC6-wDdl"}},{"cell_type":"markdown","source":["## Key Takeaways\\n","In this part of the tutorial, you\'ve learned how to train a neural network model over MEDS data -- how to convert it into a representation suitable for training a sequential neural network architecture using tools in the MEDS Ecosystem and train a simple model for a real task."],"metadata":{"id":"YueE0oFXwPow"}}]}'),u={sidebar_position:5},r="Build a (Neural Network) Model over MEDS data",s={},m=[];function c(e){const l={a:"a",em:"em",h1:"h1",header:"header",p:"p",...(0,d.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.header,{children:(0,t.jsx)(l.h1,{id:"build-a-neural-network-model-over-meds-data",children:"Build a (Neural Network) Model over MEDS data"})}),"\n",(0,t.jsxs)(l.p,{children:["In this tutorial, we'll use the dataset we extracted previously and build a ",(0,t.jsx)(l.em,{children:"neural network"})," model to predict\nthe task we extracted previously. See below for the jupyter notebook tutorial, rendered here, or check it out\nonline on ",(0,t.jsx)(l.a,{href:"https://colab.research.google.com/github/Medical-Event-Data-Standard/medical-event-data-standard.github.io/blob/main/tutorial_notebooks/KDD_tutorial/Build_a_Model_(NN).ipynb",children:"Google\nColab"}),"\nor on our ",(0,t.jsx)(l.a,{href:"https://github.com/Medical-Event-Data-Standard/medical-event-data-standard.github.io/blob/main/tutorial_notebooks/KDD_tutorial/Build_a_Model_(NN).ipynb",children:"GitHub\nRepository"})]}),"\n",(0,t.jsx)(i(),{showLineNumbers:!0,mediaAlign:"left",rawIpynb:a})]})}function w(e={}){const{wrapper:l}={...(0,d.R)(),...e.components};return l?(0,t.jsx)(l,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);