<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tutorials/basic/extracting_prediction_tasks" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Extracting a Prediction Task Cohort from MEDS Data | MEDS: a Health AI Ecosystem</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://medical-event-data-standard.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://medical-event-data-standard.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://medical-event-data-standard.github.io/docs/tutorials/basic/extracting_prediction_tasks"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Extracting a Prediction Task Cohort from MEDS Data | MEDS: a Health AI Ecosystem"><meta data-rh="true" name="description" content="To easily extract prediction tasks from MEDS Data, we will use the"><meta data-rh="true" property="og:description" content="To easily extract prediction tasks from MEDS Data, we will use the"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://medical-event-data-standard.github.io/docs/tutorials/basic/extracting_prediction_tasks"><link data-rh="true" rel="alternate" href="https://medical-event-data-standard.github.io/docs/tutorials/basic/extracting_prediction_tasks" hreflang="en"><link data-rh="true" rel="alternate" href="https://medical-event-data-standard.github.io/docs/tutorials/basic/extracting_prediction_tasks" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Tutorial - Build a Model with MEDS","item":"https://medical-event-data-standard.github.io/docs/category/tutorial---build-a-model-with-meds"},{"@type":"ListItem","position":2,"name":"Extracting a Prediction Task Cohort from MEDS Data","item":"https://medical-event-data-standard.github.io/docs/tutorials/basic/extracting_prediction_tasks"}]}</script><link rel="stylesheet" href="/assets/css/styles.af4d4dfa.css">
<script src="/assets/js/runtime~main.3d8cb0cf.js" defer="defer"></script>
<script src="/assets/js/main.15ab0ca3.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="MEDS Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo-dark.svg" alt="MEDS Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">MEDS</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro_pages/intro">Get Started</a><a class="navbar__item navbar__link" href="/docs/MEDS-DEV/intro">MEDS-DEV</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/Medical-Event-Data-Standard" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro_pages/intro">Welcome to MEDS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro_pages/what_is_MEDS">What is MEDS?</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/tutorial---build-a-model-with-meds">Tutorial - Build a Model with MEDS</a><button aria-label="Collapse sidebar category &#x27;Tutorial - Build a Model with MEDS&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/basic/converting_to_MEDS">Converting to MEDS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/basic/preprocessing_MEDS_data">Pre-processing MEDS Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/tutorials/basic/extracting_prediction_tasks">Extracting a Prediction Task Cohort from MEDS Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/basic/modeling_over_MEDS_data">Modeling over MEDS data</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro_pages/ecosystem">MEDS Ecosystem</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro_pages/roadmap">Future Roadmap</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/tutorial---build-a-model-with-meds"><span>Tutorial - Build a Model with MEDS</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Extracting a Prediction Task Cohort from MEDS Data</span></li></ul></nav><div class="theme-doc-markdown markdown"><header><h1>Extracting a Prediction Task Cohort from MEDS Data</h1></header>
<p>To easily extract prediction tasks from MEDS Data, we will use the
<a href="https://github.com/justin13601/aces/" target="_blank" rel="noopener noreferrer">ACES</a> package. This package allows you to define simple
configuration files that specify the inclusion/exclusion criteria for tasks you want to extract and have them
be automatically extractable from MEDS data via a command line interface. See the
<a href="https://eventstreamaces.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer">ACES documentation</a> for more information.</p>
<p>In this tutorial, we&#x27;ll run an end-to-end extraction of a prediction task from the MIMIC-IV Demo dataset.</p>
<div class="jupyter-viewer"><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><h2>Tutorial Set-up</h2></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source">[10]: </pre><div class="cell-content source-code"><pre style="display:block;overflow-x:auto;padding:5px 0 5px 0;background:#EEEEEE;color:black;width:37px;margin:0 0 0 0;box-sizing:border-box;border:solid 1px #E0E0E0;overflow:hidden"><code style="white-space:pre;font-family:Menlo, Consolas, &#x27;DejaVu Sans Mono&#x27;, monospace;font-size:13px"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">1</span><span> 
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">3</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">4</span></code></pre><div class="source-code-main"><pre style="display:block;overflow-x:auto;padding:5px 4px 5px 4px;background:#F5F5F5;color:black;margin:0 0 0 0;box-sizing:border-box;border:solid 1px #E0E0E0;flex:1"><code style="white-space:pre;font-family:Menlo, Consolas, &#x27;DejaVu Sans Mono&#x27;, monospace;font-size:13px"><span style="color:#00f">import</span><span> os
</span><span></span><span style="color:#00f">from</span><span> pathlib </span><span style="color:#00f">import</span><span> Path
</span>
<span>DEMO_DIR = Path(os.getenv(</span><span style="color:#a31515">&quot;MEDS_DEMO_DIR&quot;</span><span>, </span><span style="color:#a31515">&quot;./demo_output&quot;</span><span>))</span></code></pre></div></div></div></div><div class="block-output"><div class="block-light"></div><div class="block-output-content"><div></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><h3>MIMIC-IV Demo Dataset</h3></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><p>You can use the <a href="https://github.com/Medical-Event-Data-Standard/MIMIC_IV_MEDS">MIMIC_IV_MEDS</a> package to easily download and automatically transform the MIMIC-IV-Demo dataset into MEDS:</p></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source">[22]: </pre><div class="cell-content source-code"><pre style="display:block;overflow-x:auto;padding:5px 0 5px 0;background:#EEEEEE;color:black;width:37px;margin:0 0 0 0;box-sizing:border-box;border:solid 1px #E0E0E0;overflow:hidden"><code style="white-space:pre;font-family:Menlo, Consolas, &#x27;DejaVu Sans Mono&#x27;, monospace;font-size:13px"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">1</span><span> 
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">3</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">4</span></code></pre><div class="source-code-main"><pre style="display:block;overflow-x:auto;padding:5px 4px 5px 4px;background:#F5F5F5;color:black;margin:0 0 0 0;box-sizing:border-box;border:solid 1px #E0E0E0;flex:1"><code style="white-space:pre;font-family:Menlo, Consolas, &#x27;DejaVu Sans Mono&#x27;, monospace;font-size:13px"><span>OUTPUT_DIR = DEMO_DIR / </span><span style="color:#a31515">&quot;meds/&quot;</span><span>
</span><span>OUTPUT_DIR.mkdir(parents=</span><span style="color:#a31515">True</span><span>, exist_ok=</span><span style="color:#a31515">True</span><span>)
</span>
<span>!MEDS_extract-MIMIC_IV root_output_dir=$OUTPUT_DIR do_demo=</span><span style="color:#a31515">True</span><span> do_copy=</span><span style="color:#a31515">True</span><span> hydra/job_logging=disabled</span></code></pre></div></div></div></div><div class="block-output"><div class="block-light"></div><div class="block-output-content" style="max-height:0;height:200px;box-shadow:inset 0 0 6px 2px rgb(0 0 0 / 30%);resize:vertical"><div></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><h2>Extracting the Prediction Task</h2></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><h3>In-ICU Mortality</h3>
<p>For this tutorial, we&#x27;ll extract a cohort for a basic in-ICU mortality prediction task. Let&#x27;s first define our
task parameters.</p>
<p>Our goal is to predict the mortality outcome for a patient&#x27;s entire ICU admission using historical patient
data plus the initial 24 hours of data after the patient was first admitted into the ICU.</p>
<p>Suppose we only want to consider patients whose ICU admission was longer than 48 hours. As such, patients who
died or are discharged from the ICU within 48 hours of being admitted are excluded.</p>
<p><strong>Note:</strong> This task is distinct from in-<em><strong>hospital</strong></em> mortality,  <em><strong>30-day</strong></em> mortality, or <em><strong>imminent</strong></em>
mortality.</p></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><p>We can visualize this task as a series of inter-related windows using the below timeline:</p>
<p><img src="/img/icu_mortality.svg" alt="ICU Mortality"></p></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><ul>
<li>The &quot;blue&quot; region represents the &quot;<strong>input</strong>&quot; data window. All historical patient data up to and including the first 24 hours of a patient&#x27;s ICU admission will serve as input into a downstream model.</li>
<li>The &quot;red&quot; bar represents the ICU admission, and would &quot;<strong>trigger</strong>&quot; the start of our prediction task.</li>
<li>The &quot;yellow&quot; region represents the first 48 hours of a patient&#x27;s ICU admission, and we stipulate a &quot;<strong>gap</strong>&quot; whereby the patient must not have died or been discharged during that period.</li>
<li>The &quot;magenta&quot; region represents our prediction &quot;target&quot; window which can be of varying length, as it ends whenever a patient dies or is discharged.</li>
</ul></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><h3>ACES Configuration File</h3></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><p>ACES uses a configuration language to capture cohort and task definitions. Details about this configuration language is available in the <a href="https://eventstreamaces.readthedocs.io/en/latest/readme.html#task-configuration-file">ACES Documentation</a>.</p>
<p>Let&#x27;s walkthrough the construction of an ACES configuration file. At a minimum, the most basic configuration file would contain the <code>predicates</code>, <code>trigger</code>, and <code>windows</code> sections.</p></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><h4>Predicates</h4>
<p>To capture our task definition, we must first define at least three simple concepts, or ACES plain <a href="https://eventstreamaces.readthedocs.io/en/latest/notebooks/predicates.html">predicates</a>, for our demo dataset.</p>
<p>For starters, as we are specifically interested in mortality &quot;in the ICU&quot;, an <code>ICU admission</code> and a <code>ICU discharge</code> predicate would be needed to represent events where patients are officially admitted to the ICU and where patients are officially discharged. We also need the <code>death</code> predicate to capture death events so we can accurately capture the mortality component.</p>
<p>To define predicates, we would need to find how these concepts are represented in our dataset. For MIMIC-IV-Demo in MEDS format, these concepts can be found using simple regular expressions:</p>
<pre><code class="language-yaml">predicates:
  icu_admission:
    code: { regex: &quot;^ICU_ADMISSION//.*&quot; }
  icu_discharge:
    code: { regex: &quot;^ICU_DISCHARGE//.*&quot; }
  death:
    code: { regex: &quot;MEDS_DEATH.*&quot; }
</code></pre>
<p>Since patients can either die or be discharged from the ICU, we may also create a more complex concept, or an ACES derived predicate, by joining the above simple concepts using an <code>OR</code> relationship:</p>
<pre><code class="language-yaml">predicates:
  discharge_or_death:
    expr: or(icu_discharge, death)
</code></pre></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><h4>Trigger</h4>
<p>As mentioned above, a patient&#x27;s admission into the ICU triggers our prediction task. A designated field defines this ACES <a href="https://eventstreamaces.readthedocs.io/en/latest/readme.html#trigger-event">trigger</a>, and its value must always be one of the specified predicates. For our task, this predicate would be <code>icu_admission</code>:</p>
<pre><code class="language-yaml">trigger: icu_admission
</code></pre></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><h4>Windows</h4>
<p>The windows section contains the remaining three windows we defined previously - <code>input</code>, <code>gap</code>, and <code>target</code>.</p>
<p>For details on the configuration language syntax for windows, please see the <a href="https://eventstreamaces.readthedocs.io/en/latest/readme.html#windows">documentation</a>. Briefly, certain fields are present in all windows:</p>
<pre><code class="language-yaml">windows:
  window_name:
    start:
    end:
    start_inclusive:
    end_inclusive:
</code></pre>
<p>However, some windows also have optional parameters, such as the <code>has</code> field, which captures predicate count criteria for that particular window:</p>
<pre><code class="language-yaml">windows:
  window_name:
    ...
    has:
      predicate_a: (min, max)
      predicate_b: (min, max)
      ...
</code></pre></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><p>For our in-ICU mortality prediction task, we can define:</p>
<ol>
<li>
<p><code>input</code>, which begins at the start of a patient&#x27;s record (ie., <code>null</code>), and ends 24 hours past <code>trigger</code> (ie., <code>icu_admission</code>). As we&#x27;d like to include the events specified at both the start and end of <code>input</code>, if present, we can set both <code>start_inclusive</code> and <code>end_inclusive</code> as <code>True</code>.</p>
<p><strong>Note</strong>: Since we&#x27;d like our model to make a prediction at the end of <code>input</code>, we can set <code>index_timestamp</code> to be <code>end</code>, which corresponds to the timestamp of <code>trigger + 24h</code>.</p>
<pre><code class="language-yaml">windows:
  input:
    start: null
    end: trigger + 24h
    start_inclusive: True
    end_inclusive: True
    index_timestamp: end
</code></pre>
</li>
<li>
<p><code>gap</code>, which also begins at <code>trigger</code>, and ends 48 hours after. As we have included the left boundary event in <code>trigger</code> (ie., <code>icu_admission</code>), it would be reasonable to <strong>not</strong> include it again as it should not play a role in <code>gap</code>. As such, we set <code>start_inclusive</code> to <code>False</code>. As we&#x27;d like our ICU admission to be at least 48 hours long, we can place constraints specifying that there cannot be any additional <code>icu_admission</code>, <code>icu_discharge</code>, or <code>death</code> in <code>gap</code>.</p>
<pre><code class="language-yaml">windows:
  gap:
    start: trigger
    end: start + 48h
    start_inclusive: False
    end_inclusive: True
    has:
      icu_admission: (None, 0)
      discharge_or_death: (None, 0)
</code></pre>
</li>
<li>
<p><code>target</code>, which begins at the end of <code>gap</code>, and ends at the next discharge or death event (ie., <code>discharge_or_death</code> predicate). We can use this arrow notation which ACES recognizes as event references (ie., <code>-&gt;</code> and <code>&lt;-</code>; see <a href="https://eventstreamaces.readthedocs.io/en/latest/technical.html#time-range-fields">Time Range Fields</a>). In our case, we end <code>target</code> at the next <code>discharge_or_death</code>. Similarly, as we included the event at the end of <code>gap</code>, if any, already in <code>gap</code>, we can set <code>start_inclusive</code> to <code>False</code>.</p>
<p><strong>Note</strong>: Since we&#x27;d like to make a binary mortality prediction, we can extract the <code>death</code> predicate as a label from <code>target</code>, by specifying the <code>label</code> field to be <code>death</code>.</p>
<pre><code class="language-yaml">windows:
  target:
    start: gap.end
    end: start -&gt; discharge_or_death
    start_inclusive: False
    end_inclusive: True
    label: death
</code></pre>
</li>
</ol></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><p>Now, we can put all the components together to form a complete ACES configuration file that captures everything we need for our cohort and task:</p>
<pre><code class="language-yaml">predicates:
  icu_admission:
    code: { regex: &quot;^ICU_ADMISSION//.*&quot; }
  icu_discharge:
    code: { regex: &quot;^ICU_DISCHARGE//.*&quot; }
  death:
    code: { regex: &quot;MEDS_DEATH.*&quot; }
  discharge_or_death:
    expr: or(icu_discharge, death)

trigger: icu_admission

windows:
  input:
    start: null
    end: trigger + 24h
    start_inclusive: True
    end_inclusive: True
    index_timestamp: end
  gap:
    start: trigger
    end: start + 48h
    start_inclusive: False
    end_inclusive: True
    has:
      icu_admission: (None, 0)
      discharge_or_death: (None, 0)
  target:
    start: gap.end
    end: start -&gt; discharge_or_death
    start_inclusive: False
    end_inclusive: True
    label: death
</code></pre></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><h3>End-to-End Extraction using the ACES CLI</h3></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><p>With the configuration file ready, extracting the cohort from our demo dataset is extremely straightforward. All we need to do is run a simple command-line tool.</p></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source">[3]: </pre><div class="cell-content source-code"><pre style="display:block;overflow-x:auto;padding:5px 0 5px 0;background:#EEEEEE;color:black;width:37px;margin:0 0 0 0;box-sizing:border-box;border:solid 1px #E0E0E0;overflow:hidden"><code style="white-space:pre;font-family:Menlo, Consolas, &#x27;DejaVu Sans Mono&#x27;, monospace;font-size:13px"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">1</span><span> 
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">3</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">4</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">5</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">6</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">7</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">8</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">9</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">10</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">11</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">12</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">13</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">14</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">15</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">16</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">17</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">18</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">19</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">20</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">21</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">22</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">23</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">24</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">25</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">26</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">27</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">28</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">29</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">30</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">31</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">32</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">33</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">34</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">35</span></code></pre><div class="source-code-main"><pre style="display:block;overflow-x:auto;padding:5px 4px 5px 4px;background:#F5F5F5;color:black;margin:0 0 0 0;box-sizing:border-box;border:solid 1px #E0E0E0;flex:1"><code style="white-space:pre;font-family:Menlo, Consolas, &#x27;DejaVu Sans Mono&#x27;, monospace;font-size:13px"><span>in_icu = </span><span style="color:#a31515">&quot;&quot;&quot;
</span><span style="color:#a31515">predicates:
</span><span style="color:#a31515">  icu_admission:
</span><span style="color:#a31515">    code: { regex: &quot;^ICU_ADMISSION//.*&quot; }
</span><span style="color:#a31515">  icu_discharge:
</span><span style="color:#a31515">    code: { regex: &quot;^ICU_DISCHARGE//.*&quot; }
</span><span style="color:#a31515">  death:
</span><span style="color:#a31515">    code: { regex: &quot;MEDS_DEATH.*&quot; }
</span><span style="color:#a31515">  discharge_or_death:
</span><span style="color:#a31515">    expr: or(icu_discharge, death)
</span><span style="color:#a31515">
</span><span style="color:#a31515">trigger: icu_admission
</span><span style="color:#a31515">
</span><span style="color:#a31515">windows:
</span><span style="color:#a31515">  input:
</span><span style="color:#a31515">    start: null
</span><span style="color:#a31515">    end: trigger + 24h
</span><span style="color:#a31515">    start_inclusive: True
</span><span style="color:#a31515">    end_inclusive: True
</span><span style="color:#a31515">    index_timestamp: end
</span><span style="color:#a31515">  gap:
</span><span style="color:#a31515">    start: trigger
</span><span style="color:#a31515">    end: start + 48h
</span><span style="color:#a31515">    start_inclusive: False
</span><span style="color:#a31515">    end_inclusive: True
</span><span style="color:#a31515">    has:
</span><span style="color:#a31515">      icu_admission: (None, 0)
</span><span style="color:#a31515">      discharge_or_death: (None, 0)
</span><span style="color:#a31515">  target:
</span><span style="color:#a31515">    start: gap.end
</span><span style="color:#a31515">    end: start -&gt; discharge_or_death
</span><span style="color:#a31515">    start_inclusive: False
</span><span style="color:#a31515">    end_inclusive: True
</span><span style="color:#a31515">    label: death
</span><span style="color:#a31515">&quot;&quot;&quot;</span></code></pre></div></div></div></div><div class="block-output"><div class="block-light"></div><div class="block-output-content"><div></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><p>Let&#x27;s save the final configuration file in a YAML file in our demo directory:</p></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source">[4]: </pre><div class="cell-content source-code"><pre style="display:block;overflow-x:auto;padding:5px 0 5px 0;background:#EEEEEE;color:black;width:37px;margin:0 0 0 0;box-sizing:border-box;border:solid 1px #E0E0E0;overflow:hidden"><code style="white-space:pre;font-family:Menlo, Consolas, &#x27;DejaVu Sans Mono&#x27;, monospace;font-size:13px"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">1</span><span> 
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">3</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">4</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">5</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">6</span></code></pre><div class="source-code-main"><pre style="display:block;overflow-x:auto;padding:5px 4px 5px 4px;background:#F5F5F5;color:black;margin:0 0 0 0;box-sizing:border-box;border:solid 1px #E0E0E0;flex:1"><code style="white-space:pre;font-family:Menlo, Consolas, &#x27;DejaVu Sans Mono&#x27;, monospace;font-size:13px"><span>COHORT_NAME = </span><span style="color:#a31515">&quot;in_icu&quot;</span><span>
</span><span>COHORT_DIR = DEMO_DIR / </span><span style="color:#a31515">&quot;cohorts&quot;</span><span>
</span><span>COHORT_DIR.mkdir(parents=</span><span style="color:#a31515">True</span><span>, exist_ok=</span><span style="color:#a31515">True</span><span>)
</span>
<span></span><span style="color:#00f">with</span><span> </span><span style="color:#00f">open</span><span>(COHORT_DIR / </span><span style="color:#a31515">f&quot;</span><span class="hljs-subst" style="color:#a31515">{COHORT_NAME}</span><span style="color:#a31515">.yaml&quot;</span><span>, </span><span style="color:#a31515">&quot;w&quot;</span><span>) </span><span style="color:#00f">as</span><span> f:
</span>    f.write(in_icu)</code></pre></div></div></div></div><div class="block-output"><div class="block-light"></div><div class="block-output-content"><div></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><p>We can now set some variables for CLI parameters. For more information on CLI arguments, please see the <a href="https://eventstreamaces.readthedocs.io/en/latest/usage.html#detailed-instructions">documentation</a>, including <a href="https://eventstreamaces.readthedocs.io/en/latest/usage.html#multiple-shards">instructions</a> for using <code>expand_shards</code> for simultaneous extraction of cohorts over multiple MEDS shards.</p></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source">[5]: </pre><div class="cell-content source-code"><pre style="display:block;overflow-x:auto;padding:5px 0 5px 0;background:#EEEEEE;color:black;width:37px;margin:0 0 0 0;box-sizing:border-box;border:solid 1px #E0E0E0;overflow:hidden"><code style="white-space:pre;font-family:Menlo, Consolas, &#x27;DejaVu Sans Mono&#x27;, monospace;font-size:13px"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">1</span><span> 
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">3</span></code></pre><div class="source-code-main"><pre style="display:block;overflow-x:auto;padding:5px 4px 5px 4px;background:#F5F5F5;color:black;margin:0 0 0 0;box-sizing:border-box;border:solid 1px #E0E0E0;flex:1"><code style="white-space:pre;font-family:Menlo, Consolas, &#x27;DejaVu Sans Mono&#x27;, monospace;font-size:13px"><span>DATA_STANDARD = </span><span style="color:#a31515">&quot;meds&quot;</span><span>
</span><span>DATA_ROOT = OUTPUT_DIR / </span><span style="color:#a31515">&quot;MEDS_cohort/data/&quot;</span><span>
</span><span>DATA_SHARD = </span><span style="color:#a31515">&quot;$(expand_shards train/1 tuning/1 held_out/1)&quot;</span></code></pre></div></div></div></div><div class="block-output"><div class="block-light"></div><div class="block-output-content"><div></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source">[6]: </pre><div class="cell-content source-code"><pre style="display:block;overflow-x:auto;padding:5px 0 5px 0;background:#EEEEEE;color:black;width:37px;margin:0 0 0 0;box-sizing:border-box;border:solid 1px #E0E0E0;overflow:hidden"><code style="white-space:pre;font-family:Menlo, Consolas, &#x27;DejaVu Sans Mono&#x27;, monospace;font-size:13px"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">1</span><span> 
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">2</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">3</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">4</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">5</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">6</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">7</span></code></pre><div class="source-code-main"><pre style="display:block;overflow-x:auto;padding:5px 4px 5px 4px;background:#F5F5F5;color:black;margin:0 0 0 0;box-sizing:border-box;border:solid 1px #E0E0E0;flex:1"><code style="white-space:pre;font-family:Menlo, Consolas, &#x27;DejaVu Sans Mono&#x27;, monospace;font-size:13px"><span>!aces-cli \
</span>    cohort_name=$COHORT_NAME \
<!-- -->    cohort_dir=$COHORT_DIR \
<!-- -->    data=sharded \
<!-- -->    data.standard=$DATA_STANDARD \
<!-- -->    data.root=$DATA_ROOT \
<!-- -->    data.shard=$DATA_SHARD -m</code></pre></div></div></div></div><div class="block-output"><div class="block-light"></div><div class="block-output-content"><div><div class="cell-row"><pre class="cell-header output"></pre><pre class="cell-content output-std">[2025-03-25 02:15:42,893][HYDRA] Launching 3 jobs locally
[2025-03-25 02:15:42,893][HYDRA] 	#0 : cohort_name=in_icu cohort_dir=demo_output/cohorts data=sharded data.standard=meds data.root=demo_output/meds/MEDS_cohort/data data.shard=train/0
[32m2025-03-25 02:15:43.313[0m | [1mINFO    [0m | [36maces.__main__[0m:[36mmain[0m:[36m149[0m - [1mLoading config from &#x27;demo_output/cohorts/in_icu.yaml&#x27;[0m
[32m2025-03-25 02:15:43.318[0m | [1mINFO    [0m | [36maces.config[0m:[36mload[0m:[36m1341[0m - [1mParsing windows...[0m
[32m2025-03-25 02:15:43.318[0m | [1mINFO    [0m | [36maces.config[0m:[36mload[0m:[36m1350[0m - [1mParsing trigger event...[0m
[32m2025-03-25 02:15:43.318[0m | [1mINFO    [0m | [36maces.config[0m:[36mload[0m:[36m1392[0m - [1mParsing predicates...[0m
[32m2025-03-25 02:15:43.323[0m | [1mINFO    [0m | [36maces.__main__[0m:[36mmain[0m:[36m159[0m - [1mAttempting to get predicates dataframe given:
standard: meds
ts_format: &#x27;%m/%d/%Y %H:%M&#x27;
root: demo_output/meds/MEDS_cohort/data
shard: train/0
path: ${data.root}/${data.shard}.parquet
_prefix: /${data.shard}
[0m
[32m2025-03-25 02:15:43.324[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mgenerate_plain_predicates_from_meds[0m:[36m269[0m - [1mLoading MEDS data...[0m
[32m2025-03-25 02:15:43.367[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mgenerate_plain_predicates_from_meds[0m:[36m273[0m - [1mGenerating plain predicate columns...[0m
[32m2025-03-25 02:15:43.395[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mgenerate_plain_predicates_from_meds[0m:[36m277[0m - [1mAdded predicate column &#x27;icu_admission&#x27;.[0m
[32m2025-03-25 02:15:43.424[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mgenerate_plain_predicates_from_meds[0m:[36m277[0m - [1mAdded predicate column &#x27;icu_discharge&#x27;.[0m
[32m2025-03-25 02:15:43.464[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mgenerate_plain_predicates_from_meds[0m:[36m277[0m - [1mAdded predicate column &#x27;death&#x27;.[0m
[32m2025-03-25 02:15:43.464[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mgenerate_plain_predicates_from_meds[0m:[36m280[0m - [1mCleaning up predicates dataframe...[0m
[32m2025-03-25 02:15:43.505[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mget_predicates_df[0m:[36m703[0m - [1mLoaded plain predicates. Generating derived predicate columns...[0m
[32m2025-03-25 02:15:43.506[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mget_predicates_df[0m:[36m717[0m - [1mAdded predicate column &#x27;discharge_or_death&#x27;.[0m
[32m2025-03-25 02:15:43.506[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mget_predicates_df[0m:[36m724[0m - [1mGenerating special predicate columns...[0m
[32m2025-03-25 02:15:43.506[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m76[0m - [1mChecking if &#x27;(subject_id, timestamp)&#x27; columns are unique...[0m
[32m2025-03-25 02:15:43.509[0m | [1mINFO    [0m | [36maces.utils[0m:[36mlog_tree[0m:[36m67[0m - [1m
trigger
┣━━ input.end
┃   ┗━━ input.start
┗━━ gap.end
    ┗━━ target.end
[0m
[32m2025-03-25 02:15:43.510[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m85[0m - [1mBeginning query...[0m
[32m2025-03-25 02:15:43.510[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m92[0m - [1mNo static variable criteria specified, removing all rows with null timestamps...[0m
[32m2025-03-25 02:15:43.511[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m99[0m - [1mIdentifying possible trigger nodes based on the specified trigger event...[0m
[32m2025-03-25 02:15:43.511[0m | [1mINFO    [0m | [36maces.constraints[0m:[36mcheck_constraints[0m:[36m110[0m - [1mExcluding 72,774 rows as they failed to satisfy &#x27;1 &lt;= icu_admission &lt;= None&#x27;.[0m
[32m2025-03-25 02:15:43.512[0m | [1mINFO    [0m | [36maces.extract_subtree[0m:[36mextract_subtree[0m:[36m252[0m - [1mSummarizing subtree rooted at &#x27;input.end&#x27;...[0m
[32m2025-03-25 02:15:43.596[0m | [1mINFO    [0m | [36maces.extract_subtree[0m:[36mextract_subtree[0m:[36m252[0m - [1mSummarizing subtree rooted at &#x27;input.start&#x27;...[0m
[32m2025-03-25 02:15:43.707[0m | [1mINFO    [0m | [36maces.extract_subtree[0m:[36mextract_subtree[0m:[36m252[0m - [1mSummarizing subtree rooted at &#x27;gap.end&#x27;...[0m
[32m2025-03-25 02:15:43.770[0m | [1mINFO    [0m | [36maces.constraints[0m:[36mcheck_constraints[0m:[36m110[0m - [1mExcluding 2 rows as they failed to satisfy &#x27;None &lt;= icu_admission &lt;= 0&#x27;.[0m
[32m2025-03-25 02:15:43.771[0m | [1mINFO    [0m | [36maces.constraints[0m:[36mcheck_constraints[0m:[36m110[0m - [1mExcluding 53 rows as they failed to satisfy &#x27;None &lt;= discharge_or_death &lt;= 0&#x27;.[0m
[32m2025-03-25 02:15:43.772[0m | [1mINFO    [0m | [36maces.extract_subtree[0m:[36mextract_subtree[0m:[36m252[0m - [1mSummarizing subtree rooted at &#x27;target.end&#x27;...[0m
[32m2025-03-25 02:15:43.858[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m114[0m - [1mDone. 60 valid rows returned corresponding to 47 subjects.[0m
[32m2025-03-25 02:15:43.858[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m129[0m - [1mExtracting label &#x27;death&#x27; from window &#x27;target&#x27;...[0m
[32m2025-03-25 02:15:43.858[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m150[0m - [1mSetting index timestamp as &#x27;end&#x27; of window &#x27;input&#x27;...[0m
[32m2025-03-25 02:15:43.862[0m | [33m[1mWARNING [0m | [36maces.__main__[0m:[36mget_and_validate_label_schema[0m:[36m114[0m - [33m[1mOutput contains columns that are not valid MEDS label columns. For now, we are dropping them.
If you need these columns, please comment on https://github.com/justin13601/ACES/issues/97
Columns:
  - trigger
  - input.end_summary
  - input.start_summary
  - gap.end_summary
  - target.end_summary[0m
[32m2025-03-25 02:15:43.870[0m | [1mINFO    [0m | [36maces.__main__[0m:[36mmain[0m:[36m191[0m - [1mCompleted in 0:00:00.555944. Results saved to &#x27;demo_output/cohorts/in_icu/train/0.parquet&#x27;.[0m
[2025-03-25 02:15:43,871][HYDRA] 	#1 : cohort_name=in_icu cohort_dir=demo_output/cohorts data=sharded data.standard=meds data.root=demo_output/meds/MEDS_cohort/data data.shard=tuning/0
[32m2025-03-25 02:15:44.054[0m | [1mINFO    [0m | [36maces.__main__[0m:[36mmain[0m:[36m149[0m - [1mLoading config from &#x27;demo_output/cohorts/in_icu.yaml&#x27;[0m
[32m2025-03-25 02:15:44.058[0m | [1mINFO    [0m | [36maces.config[0m:[36mload[0m:[36m1341[0m - [1mParsing windows...[0m
[32m2025-03-25 02:15:44.059[0m | [1mINFO    [0m | [36maces.config[0m:[36mload[0m:[36m1350[0m - [1mParsing trigger event...[0m
[32m2025-03-25 02:15:44.059[0m | [1mINFO    [0m | [36maces.config[0m:[36mload[0m:[36m1392[0m - [1mParsing predicates...[0m
[32m2025-03-25 02:15:44.060[0m | [1mINFO    [0m | [36maces.__main__[0m:[36mmain[0m:[36m159[0m - [1mAttempting to get predicates dataframe given:
standard: meds
ts_format: &#x27;%m/%d/%Y %H:%M&#x27;
root: demo_output/meds/MEDS_cohort/data
shard: tuning/0
path: ${data.root}/${data.shard}.parquet
_prefix: /${data.shard}
[0m
[32m2025-03-25 02:15:44.060[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mgenerate_plain_predicates_from_meds[0m:[36m269[0m - [1mLoading MEDS data...[0m
[32m2025-03-25 02:15:44.064[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mgenerate_plain_predicates_from_meds[0m:[36m273[0m - [1mGenerating plain predicate columns...[0m
[32m2025-03-25 02:15:44.067[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mgenerate_plain_predicates_from_meds[0m:[36m277[0m - [1mAdded predicate column &#x27;icu_admission&#x27;.[0m
[32m2025-03-25 02:15:44.070[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mgenerate_plain_predicates_from_meds[0m:[36m277[0m - [1mAdded predicate column &#x27;icu_discharge&#x27;.[0m
[32m2025-03-25 02:15:44.074[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mgenerate_plain_predicates_from_meds[0m:[36m277[0m - [1mAdded predicate column &#x27;death&#x27;.[0m
[32m2025-03-25 02:15:44.074[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mgenerate_plain_predicates_from_meds[0m:[36m280[0m - [1mCleaning up predicates dataframe...[0m
[32m2025-03-25 02:15:44.080[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mget_predicates_df[0m:[36m703[0m - [1mLoaded plain predicates. Generating derived predicate columns...[0m
[32m2025-03-25 02:15:44.081[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mget_predicates_df[0m:[36m717[0m - [1mAdded predicate column &#x27;discharge_or_death&#x27;.[0m
[32m2025-03-25 02:15:44.081[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mget_predicates_df[0m:[36m724[0m - [1mGenerating special predicate columns...[0m
[32m2025-03-25 02:15:44.081[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m76[0m - [1mChecking if &#x27;(subject_id, timestamp)&#x27; columns are unique...[0m
[32m2025-03-25 02:15:44.082[0m | [1mINFO    [0m | [36maces.utils[0m:[36mlog_tree[0m:[36m67[0m - [1m
trigger
┣━━ input.end
┃   ┗━━ input.start
┗━━ gap.end
    ┗━━ target.end
[0m
[32m2025-03-25 02:15:44.082[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m85[0m - [1mBeginning query...[0m
[32m2025-03-25 02:15:44.083[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m92[0m - [1mNo static variable criteria specified, removing all rows with null timestamps...[0m
[32m2025-03-25 02:15:44.083[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m99[0m - [1mIdentifying possible trigger nodes based on the specified trigger event...[0m
[32m2025-03-25 02:15:44.083[0m | [1mINFO    [0m | [36maces.constraints[0m:[36mcheck_constraints[0m:[36m110[0m - [1mExcluding 6,242 rows as they failed to satisfy &#x27;1 &lt;= icu_admission &lt;= None&#x27;.[0m
[32m2025-03-25 02:15:44.084[0m | [1mINFO    [0m | [36maces.extract_subtree[0m:[36mextract_subtree[0m:[36m252[0m - [1mSummarizing subtree rooted at &#x27;input.end&#x27;...[0m
[32m2025-03-25 02:15:44.097[0m | [1mINFO    [0m | [36maces.extract_subtree[0m:[36mextract_subtree[0m:[36m252[0m - [1mSummarizing subtree rooted at &#x27;input.start&#x27;...[0m
[32m2025-03-25 02:15:44.123[0m | [1mINFO    [0m | [36maces.extract_subtree[0m:[36mextract_subtree[0m:[36m252[0m - [1mSummarizing subtree rooted at &#x27;gap.end&#x27;...[0m
[32m2025-03-25 02:15:44.136[0m | [1mINFO    [0m | [36maces.constraints[0m:[36mcheck_constraints[0m:[36m110[0m - [1mExcluding 0 rows as they failed to satisfy &#x27;None &lt;= icu_admission &lt;= 0&#x27;.[0m
[32m2025-03-25 02:15:44.136[0m | [1mINFO    [0m | [36maces.constraints[0m:[36mcheck_constraints[0m:[36m110[0m - [1mExcluding 7 rows as they failed to satisfy &#x27;None &lt;= discharge_or_death &lt;= 0&#x27;.[0m
[32m2025-03-25 02:15:44.137[0m | [1mINFO    [0m | [36maces.extract_subtree[0m:[36mextract_subtree[0m:[36m252[0m - [1mSummarizing subtree rooted at &#x27;target.end&#x27;...[0m
[32m2025-03-25 02:15:44.165[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m114[0m - [1mDone. 8 valid rows returned corresponding to 5 subjects.[0m
[32m2025-03-25 02:15:44.165[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m129[0m - [1mExtracting label &#x27;death&#x27; from window &#x27;target&#x27;...[0m
[32m2025-03-25 02:15:44.166[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m150[0m - [1mSetting index timestamp as &#x27;end&#x27; of window &#x27;input&#x27;...[0m
[32m2025-03-25 02:15:44.168[0m | [33m[1mWARNING [0m | [36maces.__main__[0m:[36mget_and_validate_label_schema[0m:[36m114[0m - [33m[1mOutput contains columns that are not valid MEDS label columns. For now, we are dropping them.
If you need these columns, please comment on https://github.com/justin13601/ACES/issues/97
Columns:
  - trigger
  - input.end_summary
  - input.start_summary
  - gap.end_summary
  - target.end_summary[0m
[32m2025-03-25 02:15:44.173[0m | [1mINFO    [0m | [36maces.__main__[0m:[36mmain[0m:[36m191[0m - [1mCompleted in 0:00:00.117831. Results saved to &#x27;demo_output/cohorts/in_icu/tuning/0.parquet&#x27;.[0m
[2025-03-25 02:15:44,174][HYDRA] 	#2 : cohort_name=in_icu cohort_dir=demo_output/cohorts data=sharded data.standard=meds data.root=demo_output/meds/MEDS_cohort/data data.shard=held_out/0
[32m2025-03-25 02:15:44.267[0m | [1mINFO    [0m | [36maces.__main__[0m:[36mmain[0m:[36m149[0m - [1mLoading config from &#x27;demo_output/cohorts/in_icu.yaml&#x27;[0m
[32m2025-03-25 02:15:44.271[0m | [1mINFO    [0m | [36maces.config[0m:[36mload[0m:[36m1341[0m - [1mParsing windows...[0m
[32m2025-03-25 02:15:44.271[0m | [1mINFO    [0m | [36maces.config[0m:[36mload[0m:[36m1350[0m - [1mParsing trigger event...[0m
[32m2025-03-25 02:15:44.271[0m | [1mINFO    [0m | [36maces.config[0m:[36mload[0m:[36m1392[0m - [1mParsing predicates...[0m
[32m2025-03-25 02:15:44.272[0m | [1mINFO    [0m | [36maces.__main__[0m:[36mmain[0m:[36m159[0m - [1mAttempting to get predicates dataframe given:
standard: meds
ts_format: &#x27;%m/%d/%Y %H:%M&#x27;
root: demo_output/meds/MEDS_cohort/data
shard: held_out/0
path: ${data.root}/${data.shard}.parquet
_prefix: /${data.shard}
[0m
[32m2025-03-25 02:15:44.273[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mgenerate_plain_predicates_from_meds[0m:[36m269[0m - [1mLoading MEDS data...[0m
[32m2025-03-25 02:15:44.275[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mgenerate_plain_predicates_from_meds[0m:[36m273[0m - [1mGenerating plain predicate columns...[0m
[32m2025-03-25 02:15:44.277[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mgenerate_plain_predicates_from_meds[0m:[36m277[0m - [1mAdded predicate column &#x27;icu_admission&#x27;.[0m
[32m2025-03-25 02:15:44.279[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mgenerate_plain_predicates_from_meds[0m:[36m277[0m - [1mAdded predicate column &#x27;icu_discharge&#x27;.[0m
[32m2025-03-25 02:15:44.281[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mgenerate_plain_predicates_from_meds[0m:[36m277[0m - [1mAdded predicate column &#x27;death&#x27;.[0m
[32m2025-03-25 02:15:44.282[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mgenerate_plain_predicates_from_meds[0m:[36m280[0m - [1mCleaning up predicates dataframe...[0m
[32m2025-03-25 02:15:44.285[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mget_predicates_df[0m:[36m703[0m - [1mLoaded plain predicates. Generating derived predicate columns...[0m
[32m2025-03-25 02:15:44.286[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mget_predicates_df[0m:[36m717[0m - [1mAdded predicate column &#x27;discharge_or_death&#x27;.[0m
[32m2025-03-25 02:15:44.286[0m | [1mINFO    [0m | [36maces.predicates[0m:[36mget_predicates_df[0m:[36m724[0m - [1mGenerating special predicate columns...[0m
[32m2025-03-25 02:15:44.286[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m76[0m - [1mChecking if &#x27;(subject_id, timestamp)&#x27; columns are unique...[0m
[32m2025-03-25 02:15:44.287[0m | [1mINFO    [0m | [36maces.utils[0m:[36mlog_tree[0m:[36m67[0m - [1m
trigger
┣━━ input.end
┃   ┗━━ input.start
┗━━ gap.end
    ┗━━ target.end
[0m
[32m2025-03-25 02:15:44.287[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m85[0m - [1mBeginning query...[0m
[32m2025-03-25 02:15:44.288[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m92[0m - [1mNo static variable criteria specified, removing all rows with null timestamps...[0m
[32m2025-03-25 02:15:44.288[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m99[0m - [1mIdentifying possible trigger nodes based on the specified trigger event...[0m
[32m2025-03-25 02:15:44.288[0m | [1mINFO    [0m | [36maces.constraints[0m:[36mcheck_constraints[0m:[36m110[0m - [1mExcluding 4,163 rows as they failed to satisfy &#x27;1 &lt;= icu_admission &lt;= None&#x27;.[0m
[32m2025-03-25 02:15:44.289[0m | [1mINFO    [0m | [36maces.extract_subtree[0m:[36mextract_subtree[0m:[36m252[0m - [1mSummarizing subtree rooted at &#x27;input.end&#x27;...[0m
[32m2025-03-25 02:15:44.298[0m | [1mINFO    [0m | [36maces.extract_subtree[0m:[36mextract_subtree[0m:[36m252[0m - [1mSummarizing subtree rooted at &#x27;input.start&#x27;...[0m
[32m2025-03-25 02:15:44.322[0m | [1mINFO    [0m | [36maces.extract_subtree[0m:[36mextract_subtree[0m:[36m252[0m - [1mSummarizing subtree rooted at &#x27;gap.end&#x27;...[0m
[32m2025-03-25 02:15:44.333[0m | [1mINFO    [0m | [36maces.constraints[0m:[36mcheck_constraints[0m:[36m110[0m - [1mExcluding 0 rows as they failed to satisfy &#x27;None &lt;= icu_admission &lt;= 0&#x27;.[0m
[32m2025-03-25 02:15:44.333[0m | [1mINFO    [0m | [36maces.constraints[0m:[36mcheck_constraints[0m:[36m110[0m - [1mExcluding 6 rows as they failed to satisfy &#x27;None &lt;= discharge_or_death &lt;= 0&#x27;.[0m
[32m2025-03-25 02:15:44.334[0m | [1mINFO    [0m | [36maces.extract_subtree[0m:[36mextract_subtree[0m:[36m252[0m - [1mSummarizing subtree rooted at &#x27;target.end&#x27;...[0m
[32m2025-03-25 02:15:44.359[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m114[0m - [1mDone. 6 valid rows returned corresponding to 4 subjects.[0m
[32m2025-03-25 02:15:44.359[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m129[0m - [1mExtracting label &#x27;death&#x27; from window &#x27;target&#x27;...[0m
[32m2025-03-25 02:15:44.360[0m | [33m[1mWARNING [0m | [36maces.query[0m:[36mquery[0m:[36m142[0m - [33m[1mAll labels in the extracted cohort are the same: &#x27;0&#x27;. This may indicate an issue with the task logic. Please double-check your configuration file if this is not expected.[0m
[32m2025-03-25 02:15:44.360[0m | [1mINFO    [0m | [36maces.query[0m:[36mquery[0m:[36m150[0m - [1mSetting index timestamp as &#x27;end&#x27; of window &#x27;input&#x27;...[0m
[32m2025-03-25 02:15:44.363[0m | [33m[1mWARNING [0m | [36maces.__main__[0m:[36mget_and_validate_label_schema[0m:[36m114[0m - [33m[1mOutput contains columns that are not valid MEDS label columns. For now, we are dropping them.
If you need these columns, please comment on https://github.com/justin13601/ACES/issues/97
Columns:
  - trigger
  - input.end_summary
  - input.start_summary
  - gap.end_summary
  - target.end_summary[0m
[32m2025-03-25 02:15:44.367[0m | [1mINFO    [0m | [36maces.__main__[0m:[36mmain[0m:[36m191[0m - [1mCompleted in 0:00:00.099429. Results saved to &#x27;demo_output/cohorts/in_icu/held_out/0.parquet&#x27;.[0m
</pre></div></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><h4>Inspecting Results</h4></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><p>The CLI would output a parquet file for every shard in each corresponding data split. Let&#x27;s examine the output for the first shard of the train split (this demo dataset only has one shard in the train split):</p></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source">[7]: </pre><div class="cell-content source-code"><pre style="display:block;overflow-x:auto;padding:5px 0 5px 0;background:#EEEEEE;color:black;width:37px;margin:0 0 0 0;box-sizing:border-box;border:solid 1px #E0E0E0;overflow:hidden"><code style="white-space:pre;font-family:Menlo, Consolas, &#x27;DejaVu Sans Mono&#x27;, monospace;font-size:13px"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">1</span><span> 
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">2</span></code></pre><div class="source-code-main"><pre style="display:block;overflow-x:auto;padding:5px 4px 5px 4px;background:#F5F5F5;color:black;margin:0 0 0 0;box-sizing:border-box;border:solid 1px #E0E0E0;flex:1"><code style="white-space:pre;font-family:Menlo, Consolas, &#x27;DejaVu Sans Mono&#x27;, monospace;font-size:13px"><span style="color:#00f">import</span><span> pandas </span><span style="color:#00f">as</span><span> pd
</span><span>results = pd.read_parquet(COHORT_DIR / COHORT_NAME / </span><span style="color:#a31515">&quot;train&quot;</span><span> / </span><span style="color:#a31515">&quot;0.parquet&quot;</span><span>)</span></code></pre></div></div></div></div><div class="block-output"><div class="block-light"></div><div class="block-output-content"><div></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><p>Here is the label distribution of the patients that met our cohort criteria:</p></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source">[8]: </pre><div class="cell-content source-code"><pre style="display:block;overflow-x:auto;padding:5px 0 5px 0;background:#EEEEEE;color:black;width:37px;margin:0 0 0 0;box-sizing:border-box;border:solid 1px #E0E0E0;overflow:hidden"><code style="white-space:pre;font-family:Menlo, Consolas, &#x27;DejaVu Sans Mono&#x27;, monospace;font-size:13px"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">1</span><span> </span></code></pre><div class="source-code-main"><pre style="display:block;overflow-x:auto;padding:5px 4px 5px 4px;background:#F5F5F5;color:black;margin:0 0 0 0;box-sizing:border-box;border:solid 1px #E0E0E0;flex:1"><code style="white-space:pre;font-family:Menlo, Consolas, &#x27;DejaVu Sans Mono&#x27;, monospace;font-size:13px"><span>results[</span><span style="color:#a31515">&#x27;boolean_value&#x27;</span><span>].value_counts()</span></code></pre></div></div></div></div><div class="block-output"><div class="block-light"></div><div class="block-output-content"><div><div class="cell-row"><pre class="cell-header output">[8]: </pre><pre class="cell-content output-std">boolean_value
False    52
True      8
Name: count, dtype: int64</pre></div></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source"></pre><div class="cell-content source-markdown"><p>Recall that our <code>label</code> predicate was set to <code>death</code> in our configuration file. Thus, we can interpret this as 8 patients who died, and 52 patients who were discharged from the ICU. The full results provide the exact <code>subject_id</code> for all patients that meet our cohort criteria, and <code>prediction_time</code> corresponds to the <code>index_timestamp</code> defined in our configuration file.</p></div></div></div></div><div class="block"><div class="block-source"><div class="block-light"></div><div class="cell-row"><pre class="cell-header source">[9]: </pre><div class="cell-content source-code"><pre style="display:block;overflow-x:auto;padding:5px 0 5px 0;background:#EEEEEE;color:black;width:37px;margin:0 0 0 0;box-sizing:border-box;border:solid 1px #E0E0E0;overflow:hidden"><code style="white-space:pre;font-family:Menlo, Consolas, &#x27;DejaVu Sans Mono&#x27;, monospace;font-size:13px"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;width:37px;padding:0 8px 0 8px;box-sizing:border-box;color:#999999">1</span><span> </span></code></pre><div class="source-code-main"><pre style="display:block;overflow-x:auto;padding:5px 4px 5px 4px;background:#F5F5F5;color:black;margin:0 0 0 0;box-sizing:border-box;border:solid 1px #E0E0E0;flex:1"><code style="white-space:pre;font-family:Menlo, Consolas, &#x27;DejaVu Sans Mono&#x27;, monospace;font-size:13px"><span>results</span></code></pre></div></div></div></div><div class="block-output"><div class="block-light"></div><div class="block-output-content"><div><div class="cell-row"><pre class="cell-header output">[9]: </pre><div class="cell-content output-display" style="justify-content:center"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subject_id</th>
      <th>prediction_time</th>
      <th>boolean_value</th>
      <th>integer_value</th>
      <th>float_value</th>
      <th>categorical_value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10002428</td>
      <td>2156-04-13 16:24:18</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10002428</td>
      <td>2156-04-20 18:11:19</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10002428</td>
      <td>2156-05-01 21:53:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10002428</td>
      <td>2156-05-12 14:49:34</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10002495</td>
      <td>2141-05-23 20:18:01</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>5</th>
      <td>10003400</td>
      <td>2137-02-26 23:37:19</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>6</th>
      <td>10003400</td>
      <td>2137-08-11 19:54:51</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>7</th>
      <td>10003400</td>
      <td>2137-08-18 17:36:37</td>
      <td>True</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>8</th>
      <td>10004235</td>
      <td>2196-02-25 17:07:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10004422</td>
      <td>2111-01-18 09:44:50</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10004720</td>
      <td>2186-11-13 19:55:00</td>
      <td>True</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>11</th>
      <td>10004733</td>
      <td>2174-12-05 11:28:24</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>12</th>
      <td>10005817</td>
      <td>2132-12-16 09:29:01</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>13</th>
      <td>10005817</td>
      <td>2135-01-04 21:55:32</td>
      <td>True</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>14</th>
      <td>10005866</td>
      <td>2149-10-03 12:48:08</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>15</th>
      <td>10005909</td>
      <td>2144-10-30 23:09:03</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>16</th>
      <td>10007058</td>
      <td>2167-11-08 20:22:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>17</th>
      <td>10007818</td>
      <td>2146-06-23 11:46:29</td>
      <td>True</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>18</th>
      <td>10007928</td>
      <td>2129-04-07 00:25:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>19</th>
      <td>10008454</td>
      <td>2110-12-01 17:11:36</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>20</th>
      <td>10009628</td>
      <td>2153-09-20 09:54:49</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>21</th>
      <td>10010471</td>
      <td>2155-12-03 20:33:00</td>
      <td>True</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>22</th>
      <td>10010867</td>
      <td>2147-12-31 09:33:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>23</th>
      <td>10012552</td>
      <td>2140-03-26 14:37:26</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>24</th>
      <td>10014078</td>
      <td>2166-08-23 00:36:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>25</th>
      <td>10014354</td>
      <td>2148-07-08 15:48:09</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>26</th>
      <td>10015272</td>
      <td>2137-06-13 18:37:22</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>27</th>
      <td>10015931</td>
      <td>2177-03-25 21:48:07</td>
      <td>True</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>28</th>
      <td>10018081</td>
      <td>2133-12-19 17:10:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>29</th>
      <td>10018081</td>
      <td>2134-08-06 14:53:33</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>30</th>
      <td>10018328</td>
      <td>2154-04-25 23:03:44</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10019003</td>
      <td>2153-03-29 02:21:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>32</th>
      <td>10019003</td>
      <td>2153-04-14 19:45:30</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>33</th>
      <td>10019003</td>
      <td>2155-07-11 17:48:57</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>34</th>
      <td>10020187</td>
      <td>2169-01-16 04:56:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>35</th>
      <td>10020306</td>
      <td>2135-01-22 17:01:57</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>36</th>
      <td>10020640</td>
      <td>2153-02-14 01:38:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>37</th>
      <td>10020944</td>
      <td>2131-02-28 16:40:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>38</th>
      <td>10021487</td>
      <td>2116-12-04 01:02:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>39</th>
      <td>10022017</td>
      <td>2189-09-11 10:05:24</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>40</th>
      <td>10023117</td>
      <td>2171-11-15 10:06:41</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>41</th>
      <td>10023117</td>
      <td>2175-03-22 03:20:53</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>42</th>
      <td>10023117</td>
      <td>2175-07-07 17:41:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>43</th>
      <td>10023239</td>
      <td>2137-06-20 19:09:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>44</th>
      <td>10023239</td>
      <td>2140-10-04 09:07:56</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>45</th>
      <td>10024043</td>
      <td>2117-04-12 22:05:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>46</th>
      <td>10025612</td>
      <td>2125-09-26 13:23:24</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>47</th>
      <td>10027445</td>
      <td>2142-08-01 01:41:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>48</th>
      <td>10027602</td>
      <td>2201-10-31 12:25:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>49</th>
      <td>10029291</td>
      <td>2123-02-21 04:13:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>50</th>
      <td>10029291</td>
      <td>2123-02-27 12:12:32</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>51</th>
      <td>10031757</td>
      <td>2137-10-16 17:29:21</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>52</th>
      <td>10032725</td>
      <td>2143-03-23 06:42:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>53</th>
      <td>10035631</td>
      <td>2116-02-29 18:43:20</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>54</th>
      <td>10037861</td>
      <td>2117-03-15 16:34:58</td>
      <td>True</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>55</th>
      <td>10037975</td>
      <td>2185-01-18 19:12:12</td>
      <td>True</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>56</th>
      <td>10038933</td>
      <td>2148-09-11 13:19:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>57</th>
      <td>10038999</td>
      <td>2131-05-23 21:50:33</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>58</th>
      <td>10039708</td>
      <td>2140-01-24 18:08:00</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
    <tr>
      <th>59</th>
      <td>10040025</td>
      <td>2148-01-25 04:50:17</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div></div></div></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/Medical-Event-Data-Standard/medical-event-data-standard.github.io/tree/main/docs/docs/tutorials/basic/extracting_prediction_tasks.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/tutorials/basic/preprocessing_MEDS_data"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Pre-processing MEDS Data</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/tutorials/basic/modeling_over_MEDS_data"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Modeling over MEDS data</div></a></nav></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro_pages/intro">Tutorials</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/meds" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/Medical-Event-Data-Standard" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Medical-Event-Data-Standard" target="_blank" rel="noopener noreferrer" class="footer__link-item">Schema</a></li><li class="footer__item"><a href="https://github.com/mmcdermott/MEDS-DEV" target="_blank" rel="noopener noreferrer" class="footer__link-item">MEDS-DEV<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Medical Event Data Standard.</div></div></div></footer></div>
</body>
</html>